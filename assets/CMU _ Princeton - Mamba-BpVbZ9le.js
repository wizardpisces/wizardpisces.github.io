const s={},a=`<p><em>&#x8BBA;&#x6587;&#x53D1;&#x5E03;&#x65F6;&#x95F4;&#xFF1A;2023-12-01</em></p>
<p>&#x7531; CMU &#x548C; Princeton &#x56E2;&#x961F;&#x53D1;&#x5E03;&#x7684; <strong>Mamba</strong>&#xFF08;&#x8BBA;&#x6587;&#x6807;&#x9898;&#x4E3A;&#x300A;<a href="https://arxiv.org/abs/2312.00752">Mamba: Linear-Time Sequence Modeling with Selective State Spaces</a>&#x300B;&#xFF09;&#x662F;&#x540E; Transformer &#x65F6;&#x4EE3;&#x6700;&#x5F3A;&#x6709;&#x529B;&#x7684;&#x6311;&#x6218;&#x8005;&#x4E4B;&#x4E00;&#x3002;</p>
<p>&#x5B83;&#x4E0D;&#x662F;&#x5BF9; Transformer &#x7684;&#x4FEE;&#x8865;&#xFF0C;&#x800C;&#x662F;&#x5BF9;&#x5176;&#x5E95;&#x5C42;&#x903B;&#x8F91;&#x7684;<strong>&#x91CD;&#x6784;</strong>&#x3002;&#x7B80;&#x5355;&#x6765;&#x8BF4;&#xFF1A;</p>
<ul>
<li><strong>&#x8BAD;&#x7EC3;&#x65F6;</strong>&#xFF1A;&#x5B83;&#x50CF; Transformer &#x4E00;&#x6837;<strong>&#x5E76;&#x884C;</strong>&#xFF08;&#x5229;&#x7528; GPU &#x7B97;&#x529B;&#xFF09;&#x3002;</li>
<li><strong>&#x63A8;&#x7406;&#x65F6;</strong>&#xFF1A;&#x5B83;&#x50CF; RNN &#x4E00;&#x6837;<strong>&#x4E32;&#x884C;</strong>&#xFF08;&#x663E;&#x5B58;&#x6052;&#x5B9A;&#xFF0C;&#x63A8;&#x7406;&#x901F;&#x5EA6; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>&#xFF09;&#x3002;</li>
<li><strong>&#x6027;&#x80FD;&#x4E0A;</strong>&#xFF1A;&#x5B83;&#x51FB;&#x8D25;&#x4E86;&#x540C;&#x89C4;&#x6A21;&#x7684; Transformer&#xFF0C;&#x5E76;&#x4E14;&#x80FD;&#x5904;&#x7406;<strong>&#x767E;&#x4E07;&#x7EA7;</strong>&#x957F;&#x5EA6;&#x7684;&#x5E8F;&#x5217;&#x3002;</li>
</ul>
<hr>
<h2 id="&#x5FC3;&#x667A;&#x6A21;&#x578B;&#xFF1A;&#x4E00;&#x53E5;&#x8BDD;&#x7406;&#x89E3; Mamba"><a href="#&#x5FC3;&#x667A;&#x6A21;&#x578B;&#xFF1A;&#x4E00;&#x53E5;&#x8BDD;&#x7406;&#x89E3; Mamba"></a>&#x5FC3;&#x667A;&#x6A21;&#x578B;&#xFF1A;&#x4E00;&#x53E5;&#x8BDD;&#x7406;&#x89E3; Mamba</h2>
<p>&#x5728;&#x6DF1;&#x5165;&#x7EC6;&#x8282;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x76F4;&#x89C9;&#xFF1A;</p>
<blockquote>
<p><strong>Mamba = &#x4E00;&#x4E2A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span> &#x7684;&#x3001;&#x53EF;&#x5B66;&#x4E60;&#x7684;&#x3001;&#x6839;&#x636E;&#x8F93;&#x5165;&#x52A8;&#x6001;&#x8C03;&#x6574;&#x66F4;&#x65B0;&#x89C4;&#x5219;&#x7684;&#x72B6;&#x6001;&#x538B;&#x7F29;&#x5668;</strong></p>
</blockquote>
<p>&#x5173;&#x952E;&#x8BCD;&#x62C6;&#x89E3;&#xFF1A;</p>
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></strong>&#xFF1A;&#x8BA1;&#x7B97;&#x91CF;&#x4E0E;&#x5E8F;&#x5217;&#x957F;&#x5EA6;&#x7EBF;&#x6027;&#x76F8;&#x5173;&#xFF08;Transformer &#x662F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF09;&#x3002;</li>
<li><strong>&#x53EF;&#x5B66;&#x4E60;</strong>&#xFF1A;&#x53C2;&#x6570;&#x901A;&#x8FC7;&#x53CD;&#x5411;&#x4F20;&#x64AD;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;&#x3002;</li>
<li><strong>&#x52A8;&#x6001;&#x8C03;&#x6574;</strong>&#xFF1A;&#x4E0D;&#x50CF;&#x4F20;&#x7EDF; RNN &#x7528;&#x56FA;&#x5B9A;&#x89C4;&#x5219;&#x5904;&#x7406;&#x6240;&#x6709;&#x8F93;&#x5165;&#xFF0C;Mamba &#x4F1A;&#x6839;&#x636E;&quot;&#x8FD9;&#x4E2A;&#x8BCD;&#x91CD;&#x4E0D;&#x91CD;&#x8981;&quot;&#x6765;&#x51B3;&#x5B9A;&#x662F;&#x8BB0;&#x4F4F;&#x8FD8;&#x662F;&#x5FFD;&#x7565;&#x3002;</li>
<li><strong>&#x72B6;&#x6001;&#x538B;&#x7F29;&#x5668;</strong>&#xFF1A;&#x628A;&#x65E0;&#x9650;&#x957F;&#x7684;&#x5386;&#x53F2;&#x4FE1;&#x606F;&#x538B;&#x7F29;&#x5230;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&quot;&#x72B6;&#x6001;&#x5411;&#x91CF;&quot; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span> &#x91CC;&#x3002;</li>
</ul>
<p><strong>&#x7406;&#x89E3; Mamba &#x53EA;&#x9700;&#x8981;&#x641E;&#x61C2;&#x4E09;&#x4EF6;&#x4E8B;&#xFF1A;</strong></p>
<ol>
<li><strong>State &#x662F;&#x4EC0;&#x4E48;&#xFF1F;</strong> &#x2014;&#x2014; &#x4E00;&#x4E2A;&#x5411;&#x91CF;&#xFF0C;&#x4EE3;&#x8868;&quot;&#x5BF9;&#x5386;&#x53F2;&#x7684;&#x538B;&#x7F29;&#x8BB0;&#x5FC6;&quot;&#x3002;</li>
<li><strong>&#x600E;&#x4E48; Update&#xFF1F;</strong> &#x2014;&#x2014; <code>&#x65B0;&#x72B6;&#x6001; = &#x65E7;&#x72B6;&#x6001; &#xD7; &#x8870;&#x51CF; + &#x65B0;&#x8F93;&#x5165; &#xD7; &#x6743;&#x91CD;</code>&#x3002;</li>
<li><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5E76;&#x884C;&#xFF1F;</strong> &#x2014;&#x2014; &#x7EBF;&#x6027;&#x9012;&#x5F52;&#x6EE1;&#x8DB3;&#x5173;&#x8054;&#x5F8B;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&quot;&#x5E76;&#x884C;&#x626B;&#x63CF;&quot;&#x7B97;&#x6CD5;&#x52A0;&#x901F;&#x3002;</li>
</ol>
<p>&#x5E26;&#x7740;&#x8FD9;&#x4E09;&#x4E2A;&#x95EE;&#x9898;&#xFF0C;&#x6211;&#x4EEC;&#x9010;&#x5C42;&#x62C6;&#x89E3;&#x3002;</p>
<hr>
<h2 id="1. &#x8BBA;&#x6587;&#x6838;&#x5FC3;&#x5BFC;&#x8BFB;"><a href="#1. &#x8BBA;&#x6587;&#x6838;&#x5FC3;&#x5BFC;&#x8BFB;"></a>1. &#x8BBA;&#x6587;&#x6838;&#x5FC3;&#x5BFC;&#x8BFB;</h2>
<p>&#x8FD9;&#x7BC7;&#x8BBA;&#x6587;&#x4E3B;&#x8981;&#x8BB2;&#x4E86;&#x4E09;&#x4E2A;&#x6545;&#x4E8B;&#xFF1A;<strong>&#x9009;&#x62E9;&#x673A;&#x5236;&#xFF08;&#x7B97;&#x6CD5;&#x5C42;&#xFF09;</strong>&#x3001;<strong>&#x786C;&#x4EF6;&#x611F;&#x77E5;&#x7B97;&#x6CD5;&#xFF08;&#x5B9E;&#x73B0;&#x5C42;&#xFF09;</strong> &#x548C; <strong>&#x6781;&#x7B80;&#x67B6;&#x6784;&#xFF08;&#x6A21;&#x578B;&#x5C42;&#xFF09;</strong>&#x3002;</p>
<h3 id="Part 1: &#x52A8;&#x673A; &#x2014;&#x2014; &#x538B;&#x7F29;&#x5373;&#x667A;&#x80FD;"><a href="#Part 1: &#x52A8;&#x673A; &#x2014;&#x2014; &#x538B;&#x7F29;&#x5373;&#x667A;&#x80FD;"></a>Part 1: &#x52A8;&#x673A; &#x2014;&#x2014; &#x538B;&#x7F29;&#x5373;&#x667A;&#x80FD;</h3>
<p>&#x4F5C;&#x8005;&#x8BA4;&#x4E3A;&#xFF0C;&#x5E8F;&#x5217;&#x5EFA;&#x6A21;&#x7684;&#x672C;&#x8D28;&#x662F;<strong>&#x5C06;&#x4E0A;&#x4E0B;&#x6587;&#x538B;&#x7F29;&#x6210;&#x4E00;&#x4E2A;&#x66F4;&#x5C0F;&#x7684;&#x72B6;&#x6001; (State)</strong>&#x3002;</p>
<ul>
<li><strong>Transformer &#x7684;&#x95EE;&#x9898;</strong>&#xFF1A;&#x5B83;<strong>&#x4E0D;&#x538B;&#x7F29;</strong>&#x3002;&#x5B83;&#x628A;&#x6240;&#x6709;&#x5386;&#x53F2;&#x8BB0;&#x5F55;&#xFF08;KV Cache&#xFF09;&#x90FD;&#x5B58;&#x7740;&#xFF0C;&#x63A8;&#x7406;&#x65F6;&#x56DE;&#x5934;&#x770B;&#x6240;&#x6709;&#x8BB0;&#x5F55;&#x3002;&#x6548;&#x679C;&#x597D;&#xFF0C;&#x4F46;&#x63A8;&#x7406;&#x6781;&#x6162;&#xFF08;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF09;&#xFF0C;&#x663E;&#x5B58;&#x7206;&#x70B8;&#x3002;</li>
<li><strong>&#x4F20;&#x7EDF; RNN/SSM &#x7684;&#x95EE;&#x9898;</strong>&#xFF1A;&#x5B83;<strong>&#x538B;&#x7F29;&#x5F97;&#x592A;&#x72E0;&#x4E14;&#x592A;&#x6B7B;&#x677F;</strong>&#x3002;&#x4E0D;&#x7BA1;&#x8F93;&#x5165;&#x662F;&#x838E;&#x58EB;&#x6BD4;&#x4E9A;&#x7684;&#x8BD7;&#x53E5;&#x8FD8;&#x662F;&#x4E71;&#x7801;&#xFF0C;&#x5B83;&#x90FD;&#x7528;&#x540C;&#x4E00;&#x5957;&#x89C4;&#x5219;&#x538B;&#x7F29;&#x3002;
<ul>
<li><strong>&#x5931;&#x8D25;&#x6848;&#x4F8B;</strong>&#xFF1A;&#x6BD4;&#x5982;&quot;&#x590D;&#x5236;&#x4EFB;&#x52A1;&quot;&#xFF08;Copying Task&#xFF09;&#x3002;</li>
<li>&#x8F93;&#x5165;&#xFF1A;<code>&quot;Hello ... (100&#x4E2A;&#x5783;&#x573E;&#x8BCD;) ... World&quot;</code></li>
<li>&#x9700;&#x6C42;&#xFF1A;&#x770B;&#x5230; Hello &#x8BB0;&#x4F4F;&#xFF0C;&#x5FFD;&#x7565;&#x5783;&#x573E;&#x8BCD;&#xFF0C;&#x6700;&#x540E;&#x8F93;&#x51FA; World&#x3002;</li>
<li>&#x4F20;&#x7EDF; SSM&#xFF1A;&#x7531;&#x4E8E;&#x53C2;&#x6570;&#x56FA;&#x5B9A;&#xFF08;LTI&#xFF09;&#xFF0C;&#x5B83;&#x65E0;&#x6CD5;&#x505A;&#x5230;&quot;&#x770B;&#x5230;&#x5783;&#x573E;&#x8BCD;&#x65F6;&#x6682;&#x505C;&#x8BB0;&#x5FC6;&#x66F4;&#x65B0;&#xFF0C;&#x770B;&#x5230; World &#x65F6;&#x7ACB;&#x523B;&#x8F93;&#x51FA;&quot;&#x3002;</li>
</ul>
</li>
</ul>
<p><strong>&#x6838;&#x5FC3;&#x6D1E;&#x5BDF;</strong>&#xFF1A;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E00;&#x4E2A;<strong>&#x6709;&#x9009;&#x62E9;&#x6027;</strong>&#x7684;&#x538B;&#x7F29;&#x673A;&#x3002;&#x5B83;&#x5E94;&#x8BE5;&#x77E5;&#x9053;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x8BE5;<strong>&#x8BB0;&#x4F4F;</strong>&#xFF0C;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x8BE5;<strong>&#x9057;&#x5FD8;</strong>&#x3002;</p>
<h3 id="Part 2: &#x9009;&#x62E9;&#x6027;&#x673A;&#x5236; &#x2014;&#x2014; &#x7ED9;&#x6A21;&#x578B;&#x88C5;&#x4E0A;&quot;&#x9600;&#x95E8;&quot;"><a href="#Part 2: &#x9009;&#x62E9;&#x6027;&#x673A;&#x5236; &#x2014;&#x2014; &#x7ED9;&#x6A21;&#x578B;&#x88C5;&#x4E0A;&quot;&#x9600;&#x95E8;&quot;"></a>Part 2: &#x9009;&#x62E9;&#x6027;&#x673A;&#x5236; &#x2014;&#x2014; &#x7ED9;&#x6A21;&#x578B;&#x88C5;&#x4E0A;&quot;&#x9600;&#x95E8;&quot;</h3>
<p>&#x8FD9;&#x662F; Mamba &#x7684;&#x7075;&#x9B42;&#x3002;&#x4F5C;&#x8005;&#x4FEE;&#x6539;&#x4E86;&#x6807;&#x51C6; SSM &#x7684;&#x516C;&#x5F0F;&#x3002;</p>
<ul>
<li>
<p><strong>&#x6807;&#x51C6; SSM (S4)</strong>&#xFF1A;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>A</mi><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>B</mi><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = A h_{t-1} + B x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>
&#x8FD9;&#x91CC;&#x7684; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo separator="true">,</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A, B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">A</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> &#x662F;&#x5E38;&#x6570;&#x77E9;&#x9635;&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6A21;&#x578B;&#x5904;&#x7406;&#x6570;&#x636E;&#x7684;&#x89C4;&#x5219;&#x662F;<strong>&#x9759;&#x6001;</strong>&#x7684;&#xFF0C;&#x4E0E;&#x8F93;&#x5165;&#x5185;&#x5BB9;&#x65E0;&#x5173;&#x3002;</p>
</li>
<li>
<p><strong>&#x9009;&#x62E9;&#x6027; SSM (Mamba/S6)</strong>&#xFF1A;
&#x4F5C;&#x8005;&#x8BA9;&#x53C2;&#x6570;&#x53D8;&#x6210;&#x4E86;<strong>&#x8F93;&#x5165;&#x7684;&#x51FD;&#x6570;</strong>&#xFF1A;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>B</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><msub><mi>s</mi><mi>B</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi>C</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><msub><mi>s</mi><mi>C</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mi mathvariant="normal">&#x394;</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><mtext>Softplus</mtext><mo stretchy="false">(</mo><mtext>Linear</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\\begin{aligned}
B &amp;= s_B(x_t) \\
C &amp;= s_C(x_t) \\
\\Delta &amp;= \\text{Softplus}(\\text{Linear}(x_t))
\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5em;vertical-align:-2em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">&#x394;</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-1.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord text"><span class="mord">Softplus</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Linear</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span> (&#x8F93;&#x5165;&#x9600;&#x95E8;)</strong>&#xFF1A;&#x6839;&#x636E;&#x5F53;&#x524D;&#x8BCD; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x51B3;&#x5B9A;&#xFF0C;&#x8BA9;&#x591A;&#x5C11;&#x4FE1;&#x606F;&#x8FDB;&#x5165;&#x8BB0;&#x5FC6;&#x3002;</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> (&#x8F93;&#x51FA;&#x9600;&#x95E8;)</strong>&#xFF1A;&#x6839;&#x636E;&#x5F53;&#x524D;&#x8BCD; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x51B3;&#x5B9A;&#xFF0C;&#x4ECE;&#x8BB0;&#x5FC6;&#x91CC;&#x63D0;&#x53D6;&#x591A;&#x5C11;&#x4FE1;&#x606F;&#x4F5C;&#x4E3A;&#x8F93;&#x51FA;&#x3002;</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> (&#x65F6;&#x95F4;&#x6B65;&#x957F;/&#x9057;&#x5FD8;&#x9600;&#x95E8;)</strong>&#xFF1A;&#x8FD9;&#x662F;&#x6700;&#x5173;&#x952E;&#x7684;&#x3002;
<ul>
<li>&#x5F53; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\Delta \\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF1A;&#x5FFD;&#x7565;&#x5F53;&#x524D;&#x8F93;&#x5165;&#xFF0C;&#x4FDD;&#x6301;&#x5386;&#x53F2;&#x72B6;&#x6001;&#x4E0D;&#x53D8;&#xFF08;&#x8DF3;&#x8FC7;&#x5E9F;&#x8BDD;&#xFF09;&#x3002;</li>
<li>&#x5F53; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x2192;</mo><mtext>large</mtext></mrow><annotation encoding="application/x-tex">\\Delta \\to \\text{large}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">large</span></span></span></span></span>&#xFF1A;&#x805A;&#x7126;&#x5F53;&#x524D;&#x8F93;&#x5165;&#xFF0C;&#x8986;&#x76D6;&#x5386;&#x53F2;&#x72B6;&#x6001;&#xFF08;&#x8BB0;&#x4F4F;&#x91CD;&#x70B9;&#xFF09;&#x3002;</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="Part 3: &#x786C;&#x4EF6;&#x611F;&#x77E5;&#x7B97;&#x6CD5; &#x2014;&#x2014; &#x5982;&#x4F55;&#x5728; GPU &#x4E0A;&#x8DD1;&#x5F97;&#x5FEB;&#xFF1F;"><a href="#Part 3: &#x786C;&#x4EF6;&#x611F;&#x77E5;&#x7B97;&#x6CD5; &#x2014;&#x2014; &#x5982;&#x4F55;&#x5728; GPU &#x4E0A;&#x8DD1;&#x5F97;&#x5FEB;&#xFF1F;"></a>Part 3: &#x786C;&#x4EF6;&#x611F;&#x77E5;&#x7B97;&#x6CD5; &#x2014;&#x2014; &#x5982;&#x4F55;&#x5728; GPU &#x4E0A;&#x8DD1;&#x5F97;&#x5FEB;&#xFF1F;</h3>
<p><strong>&#x5927;&#x9EBB;&#x70E6;</strong>&#xFF1A;&#x5F15;&#x5165;&#x9009;&#x62E9;&#x6027;&#x540E;&#xFF0C;&#x53C2;&#x6570;&#x968F;&#x65F6;&#x95F4;&#x53D8;&#x5316;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> &#x53D8;&#x6210;&#x4E86; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">A_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#x3002;&#x8FD9;&#x610F;&#x5473;&#x7740;&#x6211;&#x4EEC;**&#x4E0D;&#x80FD;&#x518D;&#x4F7F;&#x7528;&#x5377;&#x79EF;&#xFF08;Convolution&#xFF09;**&#x6765;&#x5E76;&#x884C;&#x8BA1;&#x7B97;&#x4E86;&#xFF01;&#x6211;&#x4EEC;&#x88AB;&#x8FEB;&#x56DE;&#x5230;&#x4E86; RNN &#x7684;&#x9012;&#x5F52;&#x8BA1;&#x7B97;&#xFF08;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x4F9D;&#x8D56; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">h_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>&#xFF09;&#x3002;
&#x5728; Python/PyTorch &#x91CC;&#x8DD1; <code>for</code> &#x5FAA;&#x73AF;&#x662F;&#x6781;&#x6162;&#x7684;&#xFF0C;GPU &#x4F1A;&#x5904;&#x4E8E;&#x95F2;&#x7F6E;&#x72B6;&#x6001;&#x3002;</p>
<p><strong>&#x89E3;&#x51B3;&#x65B9;&#x6848;</strong>&#xFF1A;</p>
<ol>
<li><strong>&#x5E76;&#x884C;&#x626B;&#x63CF; (Parallel Scan)</strong>&#xFF1A;
&#x867D;&#x7136;&#x903B;&#x8F91;&#x662F;&#x9012;&#x5F52;&#x7684;&#xFF0C;&#x4F46;&#x56E0;&#x4E3A;&#x662F;&#x7EBF;&#x6027;&#x8FD0;&#x7B97;&#xFF0C;&#x53EF;&#x4EE5;&#x5229;&#x7528;<strong>&#x524D;&#x7F00;&#x548C; (Prefix Sum)</strong> &#x7B97;&#x6CD5;&#x8FDB;&#x884C;&#x5E76;&#x884C;&#x5316;&#x3002;
<ul>
<li>&#x6BD4;&#x5982;&#x7B97; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mn>3</mn></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">x_1 \\cdot x_2 \\cdot x_3 \\cdot x_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5945em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x4E00;&#x6B65;&#x6B65;&#x4E58;&#x3002;&#x53EF;&#x4EE5;&#x5E76;&#x884C;&#x7B97; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1 \\cdot x_2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &#x548C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>3</mn></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mn>4</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_3 \\cdot x_4)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF0C;&#x7136;&#x540E;&#x518D;&#x4E58;&#x7ED3;&#x679C;&#x3002;</li>
</ul>
</li>
<li><strong>&#x5185;&#x6838;&#x878D;&#x5408; (Kernel Fusion)</strong>&#xFF1A;
<strong>&#x74F6;&#x9888;&#x4E0D;&#x5728;&#x8BA1;&#x7B97;&#xFF0C;&#x800C;&#x5728;&#x5185;&#x5B58; IO (HBM)</strong>&#x3002;
<ul>
<li>Mamba &#x8BBE;&#x8BA1;&#x4E86;&#x4E00;&#x4E2A;&#x7279;&#x6B8A;&#x7684; CUDA Kernel&#x3002;&#x5B83;&#x4E0D;&#x628A;&#x5DE8;&#x5927;&#x7684;&#x4E2D;&#x95F4;&#x72B6;&#x6001;&#x77E9;&#x9635;&#xFF08;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo separator="true">,</mo><mi>L</mi><mo separator="true">,</mo><mi>D</mi><mo separator="true">,</mo><mi>N</mi></mrow><annotation encoding="application/x-tex">B, L, D, N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>&#xFF09;&#x5199;&#x56DE;&#x663E;&#x5B58;&#xFF08;HBM&#xFF09;&#xFF0C;&#x800C;&#x662F;&#x76F4;&#x63A5;&#x5728; GPU &#x7684;**&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF08;SRAM&#xFF09;**&#x91CC;&#x4E00;&#x53E3;&#x6C14;&#x7B97;&#x5B8C;&#x3002;</li>
<li><strong>&#x7ED3;&#x679C;</strong>&#xFF1A;&#x901F;&#x5EA6;&#x6BD4;&#x6807;&#x51C6;&#x5B9E;&#x73B0;&#x5FEB;&#x4E86; <strong>40 &#x500D;</strong>&#x3002;</li>
</ul>
</li>
</ol>
<h3 id="Part 4: &#x67B6;&#x6784; &#x2014;&#x2014; Mamba Block"><a href="#Part 4: &#x67B6;&#x6784; &#x2014;&#x2014; Mamba Block"></a>Part 4: &#x67B6;&#x6784; &#x2014;&#x2014; Mamba Block</h3>
<p>Mamba &#x629B;&#x5F03;&#x4E86; Attention &#x548C; MLP &#x7684;&#x5206;&#x5C42;&#x7ED3;&#x6784;&#xFF0C;&#x8BBE;&#x8BA1;&#x4E86;&#x4E00;&#x4E2A;&#x6781;&#x5176;&#x7B80;&#x5355;&#x7684; Block&#xFF1A;</p>
<pre><code>Input (x)
  |
  +----&gt; &#x5206;&#x652F;1: Expand -&gt; Conv1d -&gt; SiLU -&gt; SSM (&#x9009;&#x62E9;&#x6027;&#x6838;&#x5FC3;)
  |
  +----&gt; &#x5206;&#x652F;2: Expand -&gt; SiLU (&#x95E8;&#x63A7;)
  |
  x (&#x4E58;&#x6CD5;&#x878D;&#x5408;)
  |
Output
</code></pre>
<p>&#x8FD9;&#x4E2A;&#x7ED3;&#x6784;&#x88AB;&#x79F0;&#x4E3A; <strong>SSM-based SwiGLU</strong>&#x3002;&#x5B83;&#x628A;&#x5E8F;&#x5217;&#x6DF7;&#x5408;&#xFF08;SSM&#xFF09;&#x548C;&#x901A;&#x9053;&#x53D8;&#x6362;&#xFF08;Projections&#xFF09;&#x878D;&#x5408;&#x5728;&#x4E86;&#x4E00;&#x8D77;&#x3002;</p>
<hr>
<h2 id="2. &#x5E02;&#x573A;&#x73B0;&#x72B6;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x8FD8;&#x6CA1;&#x7EDF;&#x6CBB;&#x4E16;&#x754C;&#xFF1F;"><a href="#2. &#x5E02;&#x573A;&#x73B0;&#x72B6;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x8FD8;&#x6CA1;&#x7EDF;&#x6CBB;&#x4E16;&#x754C;&#xFF1F;"></a>2. &#x5E02;&#x573A;&#x73B0;&#x72B6;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x8FD8;&#x6CA1;&#x7EDF;&#x6CBB;&#x4E16;&#x754C;&#xFF1F;</h2>
<p>&#x867D;&#x7136; Mamba &#x5728;&#x8BBA;&#x6587;&#x4E2D;&#x540A;&#x6253; Transformer&#xFF0C;&#x4F46;&#x5728;&#x5B9E;&#x9645;&#x843D;&#x5730;&#xFF08;2024-2025&#xFF09;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x770B;&#x5230;&#x7684;&#x662F;<strong>&#x6DF7;&#x5408;&#x67B6;&#x6784;</strong>&#x7684;&#x5174;&#x8D77;&#x3002;</p>
<h3 id="1. &#x7EAF; Mamba &#x7684;&#x5C40;&#x9650;&#x6027;"><a href="#1. &#x7EAF; Mamba &#x7684;&#x5C40;&#x9650;&#x6027;"></a>1. &#x7EAF; Mamba &#x7684;&#x5C40;&#x9650;&#x6027;</h3>
<ul>
<li><strong>&quot;In-Context Learning&quot; (ICL) &#x80FD;&#x529B;</strong>&#xFF1A;Transformer &#x7684; Attention &#x673A;&#x5236;&#x672C;&#x8D28;&#x4E0A;&#x662F;&#x4E00;&#x4E2A;&quot;&#x5185;&#x5BB9;&#x5BFB;&#x5740;&#x7684;&#x6570;&#x636E;&#x5E93;&quot;&#x3002;&#x5BF9;&#x4E8E;&quot;&#x4ECE;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x627E;&#x4E00;&#x4E2A;&#x8BCD;&quot;&#x8FD9;&#x79CD;&#x4EFB;&#x52A1;&#xFF0C;Attention &#x662F;&#x5B8C;&#x7F8E;&#x7684;&#xFF08;Recall=100%&#xFF09;&#x3002;&#x800C; Mamba &#x662F;&#x6709;&#x635F;&#x538B;&#x7F29;&#xFF0C;&#x5BF9;&#x4E8E;&#x6781;&#x957F;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x5FAE;&#x5C0F;&#x7EC6;&#x8282;&#x7684;&#x56DE;&#x6EAF;&#xFF0C;&#x4ECD;&#x7136;&#x4E0D;&#x5982; Attention &#x7CBE;&#x51C6;&#x3002;</li>
<li><strong>&#x8BAD;&#x7EC3;&#x7A33;&#x5B9A;&#x6027;</strong>&#xFF1A;&#x5728;&#x6269;&#x5927;&#x5230; 100B &#x53C2;&#x6570;&#x7EA7;&#x522B;&#x65F6;&#xFF0C;Transformer &#x5DF2;&#x7ECF;&#x6709;&#x4E86;&#x4E00;&#x5957;&#x6210;&#x719F;&#x7684;&#x70BC;&#x4E39;&#x624B;&#x518C;&#xFF08;&#x521D;&#x59CB;&#x5316;&#x3001;&#x5F52;&#x4E00;&#x5316;&#x3001;&#x5B66;&#x4E60;&#x7387;&#x8C03;&#x5EA6;&#xFF09;&#xFF0C;&#x800C; Mamba &#x8FD8;&#x5728;&#x6478;&#x7D22;&#xFF0C;&#x5BB9;&#x6613;&#x51FA;&#x73B0; Loss Spike&#x3002;</li>
</ul>
<h3 id="2. &#x4E3B;&#x6D41;&#x6A21;&#x578B;&#x7684;&#x8DDF;&#x8FDB;"><a href="#2. &#x4E3B;&#x6D41;&#x6A21;&#x578B;&#x7684;&#x8DDF;&#x8FDB;"></a>2. &#x4E3B;&#x6D41;&#x6A21;&#x578B;&#x7684;&#x8DDF;&#x8FDB;</h3>
<p>&#x4E1A;&#x754C;&#x6B63;&#x5728;&#x91C7;&#x7528; <strong>Transformer-Mamba Hybrid</strong> &#x65B9;&#x6848;&#xFF1A;</p>
<ul>
<li><strong>Jamba (AI21 Labs)</strong>: &#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x57FA;&#x4E8E; Mamba &#x7684;&#x91CF;&#x4EA7;&#x5927;&#x6A21;&#x578B;&#x3002;&#x67B6;&#x6784;&#x662F;&#x5C42;&#x7EA7;&#x6DF7;&#x5408;&#xFF1A;&#x6BCF; 8 &#x5C42; Mamba &#x5939; 1 &#x5C42; Attention&#x3002;
<ul>
<li><em>&#x76EE;&#x7684;</em>&#xFF1A;&#x7528; Mamba &#x5904;&#x7406;&#x6D77;&#x91CF;&#x80CC;&#x666F;&#x4FE1;&#x606F;&#xFF08;&#x7701;&#x663E;&#x5B58;&#xFF09;&#xFF0C;&#x7528; Attention &#x5904;&#x7406;&#x5173;&#x952E;&#x7684;&#x67E5;&#x8BE2;&#xFF08;&#x4FDD;&#x7CBE;&#x5EA6;&#xFF09;&#x3002;</li>
</ul>
</li>
<li><strong>Codestral (Mistral)</strong>: &#x8FD9;&#x91CC;&#x7684; 7B &#x6A21;&#x578B;&#x4F7F;&#x7528;&#x4E86; Mamba &#x67B6;&#x6784;&#xFF0C;&#x4E13;&#x95E8;&#x7528;&#x4E8E;&#x4EE3;&#x7801;&#x751F;&#x6210;&#xFF08;&#x4EE3;&#x7801;&#x901A;&#x5E38;&#x5F88;&#x957F;&#x4E14;&#x6709;&#x5F3A;&#x903B;&#x8F91;&#x4F9D;&#x8D56;&#xFF09;&#x3002;</li>
<li><strong>Zamba (Zyphra)</strong>: &#x4E5F;&#x662F;&#x6DF7;&#x5408;&#x67B6;&#x6784;&#xFF0C;&#x5229;&#x7528; SSM &#x63D0;&#x9AD8;&#x63A8;&#x7406;&#x541E;&#x5410;&#x91CF;&#x3002;</li>
</ul>
<h3 id="3. &#x751F;&#x6001;&#x58C1;&#x5792;"><a href="#3. &#x751F;&#x6001;&#x58C1;&#x5792;"></a>3. &#x751F;&#x6001;&#x58C1;&#x5792;</h3>
<p>Transformer &#x62E5;&#x6709; <strong>FlashAttention</strong>&#x3001;<strong>vLLM</strong>&#x3001;<strong>TensorRT-LLM</strong> &#x7B49;&#x6DF1;&#x5EA6;&#x7684;&#x5DE5;&#x7A0B;&#x4F18;&#x5316;&#x3002;Mamba &#x9700;&#x8981;&#x91CD;&#x5199;&#x8FD9;&#x4E00;&#x5957;&#x57FA;&#x7840;&#x8BBE;&#x65BD;&#xFF0C;&#x8FD9;&#x9700;&#x8981;&#x65F6;&#x95F4;&#x3002;</p>
<hr>
<h2 id="3. &#x5168;&#x8C8C;&#x5BF9;&#x6BD4;&#xFF1A;Mamba vs Transformer"><a href="#3. &#x5168;&#x8C8C;&#x5BF9;&#x6BD4;&#xFF1A;Mamba vs Transformer"></a>3. &#x5168;&#x8C8C;&#x5BF9;&#x6BD4;&#xFF1A;Mamba vs Transformer</h2>
<p>&#x65E2;&#x7136;&#x4F60;&#x719F;&#x6089; Transformer&#xFF0C;&#x6211;&#x4EEC;&#x5C31;&#x76F4;&#x63A5;&#x5BF9;&#x6BD4;&#x4E24;&#x8005;&#x7684;<strong>&#x6700;&#x5C0F;&#x5355;&#x5143;&#xFF08;Block&#xFF09;<strong>&#x548C;</strong>&#x5B8F;&#x89C2;&#x67B6;&#x6784;</strong>&#x3002;</p>
<h3 id="A. &#x5B8F;&#x89C2;&#x67B6;&#x6784;&#xFF1A;&#x5806;&#x53E0;&#x65B9;&#x5F0F;&#x7684;&#x6539;&#x53D8;"><a href="#A. &#x5B8F;&#x89C2;&#x67B6;&#x6784;&#xFF1A;&#x5806;&#x53E0;&#x65B9;&#x5F0F;&#x7684;&#x6539;&#x53D8;"></a>A. &#x5B8F;&#x89C2;&#x67B6;&#x6784;&#xFF1A;&#x5806;&#x53E0;&#x65B9;&#x5F0F;&#x7684;&#x6539;&#x53D8;</h3>
<ul>
<li>
<p><strong>Transformer</strong> &#x7684;&#x5B8F;&#x89C2;&#x67B6;&#x6784;&#x662F;&#xFF1A;</p>
<pre><code>Input -&gt; [ Multi-Head Attention -&gt; Add &amp; Norm -&gt; Feed Forward (MLP) -&gt; Add &amp; Norm ] x N -&gt; Output
</code></pre>
<p>&#x5B83;&#x6709;&#x4E24;&#x4E2A;&#x6838;&#x5FC3;&#x7EC4;&#x4EF6;&#x4EA4;&#x66FF;&#xFF1A;<strong>Attention</strong>&#xFF08;&#x6DF7;&#x5408;&#x65F6;&#x95F4;&#x4FE1;&#x606F;&#xFF0C;&#x63D0;&#x53D6;&#x4E0A;&#x4E0B;&#x6587;&#xFF09;&#x548C; <strong>MLP</strong>&#xFF08;&#x6DF7;&#x5408;&#x901A;&#x9053;&#x4FE1;&#x606F;&#xFF0C;&#x5904;&#x7406;&#x7279;&#x5F81;&#xFF09;&#x3002;</p>
</li>
<li>
<p><strong>Mamba</strong> &#x7684;&#x5B8F;&#x89C2;&#x67B6;&#x6784;&#x662F;&#xFF1A;</p>
<pre><code>Input -&gt; [ Mamba Block ] x N -&gt; Output
</code></pre>
<p>Mamba &#x629B;&#x5F03;&#x4E86;&quot;Attention + MLP&quot;&#x7684;&#x7EC4;&#x5408;&#xFF0C;&#x76F4;&#x63A5;&#x4F7F;&#x7528;&#x7EDF;&#x4E00;&#x7684; <strong>Mamba Block</strong>&#x3002;&#x8FD9;&#x4E2A; Block &#x65E2;&#x8D1F;&#x8D23;&#x63D0;&#x53D6;&#x4E0A;&#x4E0B;&#x6587;&#xFF08;&#x5E8F;&#x5217;&#x6DF7;&#x5408;&#xFF09;&#xFF0C;&#x4E5F;&#x8D1F;&#x8D23;&#x7279;&#x5F81;&#x53D8;&#x6362;&#xFF08;&#x901A;&#x9053;&#x6DF7;&#x5408;&#xFF09;&#x3002;</p>
</li>
</ul>
<h3 id="B. &#x5FAE;&#x89C2;&#x7ED3;&#x6784;&#xFF1A;Block &#x5185;&#x90E8;&#x53D1;&#x751F;&#x4E86;&#x4EC0;&#x4E48;&#xFF1F;"><a href="#B. &#x5FAE;&#x89C2;&#x7ED3;&#x6784;&#xFF1A;Block &#x5185;&#x90E8;&#x53D1;&#x751F;&#x4E86;&#x4EC0;&#x4E48;&#xFF1F;"></a>B. &#x5FAE;&#x89C2;&#x7ED3;&#x6784;&#xFF1A;Block &#x5185;&#x90E8;&#x53D1;&#x751F;&#x4E86;&#x4EC0;&#x4E48;&#xFF1F;</h3>
<p>&#x8BA9;&#x6211;&#x4EEC;&#x6253;&#x5F00;&#x9ED1;&#x76D2;&#xFF0C;&#x770B;&#x770B;&#x6570;&#x636E;&#x662F;&#x5982;&#x4F55;&#x6D41;&#x52A8;&#x7684;&#xFF1A;</p>
<h4 id="Transformer Block (&#x4F20;&#x7EDF;)"><a href="#Transformer Block (&#x4F20;&#x7EDF;)"></a>Transformer Block (&#x4F20;&#x7EDF;)</h4>
<ol>
<li><strong>&#x8F93;&#x5165; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></strong> &#x5206;&#x6D41;&#x3002;</li>
<li><strong>&#x5206;&#x652F; 1 (Attention)</strong>&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>&#x2192;</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo>&#x2192;</mo><mtext>Softmax</mtext><mo stretchy="false">(</mo><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mi>V</mi><mo>&#x2192;</mo><mtext>Output</mtext></mrow><annotation encoding="application/x-tex">X \\to Q, K, V \\to \\text{Softmax}(QK^T)V \\to \\text{Output}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Softmax</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Output</span></span></span></span></span>&#x3002;
<ul>
<li><em>&#x75DB;&#x70B9;</em>&#xFF1A;&#x8BA1;&#x7B97;&#x91CF; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>&#xFF0C;&#x663E;&#x5B58;&#x5360;&#x7528; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>N</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">N^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>&#x3002;</li>
</ul>
</li>
<li><strong>&#x5206;&#x652F; 2 (MLP)</strong>&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>&#x2192;</mo><mtext>Linear</mtext><mo>&#x2192;</mo><mtext>ReLU</mtext><mo>&#x2192;</mo><mtext>Linear</mtext><mo>&#x2192;</mo><mtext>Output</mtext></mrow><annotation encoding="application/x-tex">X \\to \\text{Linear} \\to \\text{ReLU} \\to \\text{Linear} \\to \\text{Output}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Linear</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">Linear</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Output</span></span></span></span></span>&#x3002;</li>
<li><strong>&#x6B8B;&#x5DEE;&#x8FDE;&#x63A5;</strong>&#xFF1A;&#x52A0;&#x8D77;&#x6765;&#x3002;</li>
</ol>
<h4 id="Mamba Block (&#x73B0;&#x4EE3; SSM)"><a href="#Mamba Block (&#x73B0;&#x4EE3; SSM)"></a>Mamba Block (&#x73B0;&#x4EE3; SSM)</h4>
<p>Mamba Block &#x7684;&#x8BBE;&#x8BA1;&#x6DF1;&#x53D7; <strong>H3</strong> (Hungry Hungry Hippos) &#x548C; <strong>Gated MLP</strong> &#x7684;&#x542F;&#x53D1;&#x3002;&#x5B83;&#x957F;&#x8FD9;&#x6837;&#xFF1A;</p>
<ol>
<li><strong>&#x8F93;&#x5165; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span></strong>&#xFF1A;&#x7EF4;&#x5EA6; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>B</mi><mo separator="true">,</mo><mi>L</mi><mo separator="true">,</mo><mi>D</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(B, L, D)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mclose">)</span></span></span></span>&#x3002;</li>
<li><strong>&#x8F93;&#x5165;&#x6295;&#x5F71; (Expand)</strong>&#xFF1A;&#x5C06;&#x7EF4;&#x5EA6;&#x653E;&#x5927;&#x5230; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>&#xD7;</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">E \\times D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#xD7;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>&#xFF08;&#x901A;&#x5E38; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">E=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>&#xFF09;&#x3002;&#x751F;&#x6210;&#x4E24;&#x4E2A;&#x5206;&#x652F;&#x3002;</li>
<li><strong>&#x5206;&#x652F; 1 (&#x4E3B;&#x5904;&#x7406;&#x6D41;)&#xFF1A;</strong>
<ul>
<li><strong>Conv1d</strong>&#xFF1A;&#x5148;&#x7ECF;&#x8FC7;&#x4E00;&#x4E2A;&#x5C0F;&#x7684; 1D &#x5377;&#x79EF;&#xFF08;&#x7A97;&#x53E3;&#x5927;&#x5C0F; 4&#xFF09;&#xFF0C;&#x4F5C;&#x7528;&#x7C7B;&#x4F3C;&#x4E8E; N-gram&#xFF0C;&#x6355;&#x6349;<strong>&#x6781;&#x5C40;&#x90E8;</strong>&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x4FE1;&#x606F;&#x3002;</li>
<li><strong>SiLU &#x6FC0;&#x6D3B;</strong>&#x3002;</li>
<li><strong>SSM (&#x6838;&#x5FC3;)</strong>&#xFF1A;&#x8FD9;&#x662F; Mamba &#x7684;&#x5FC3;&#x810F;&#x3002;&#x7ECF;&#x8FC7;**&#x9009;&#x62E9;&#x6027;&#x72B6;&#x6001;&#x7A7A;&#x95F4;&#x6A21;&#x578B;&#xFF08;Selective SSM&#xFF09;**&#x8FDB;&#x884C;&#x5E8F;&#x5217;&#x5EFA;&#x6A21;&#x3002;&#x8FD9;&#x662F;&#x66FF;&#x4EE3; Attention &#x7684;&#x90E8;&#x5206;&#x3002;</li>
</ul>
</li>
<li><strong>&#x5206;&#x652F; 2 (&#x95E8;&#x63A7;&#x6D41;)&#xFF1A;</strong>
<ul>
<li><strong>SiLU &#x6FC0;&#x6D3B;</strong>&#xFF1A;&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x4E58;&#x6CD5;&#x95E8;&#xFF08;Gating Mechanism&#xFF09;&#x3002;</li>
</ul>
</li>
<li><strong>&#x4E58;&#x6CD5;&#x878D;&#x5408;</strong>&#xFF1A;&#x5206;&#x652F; 1 &#x7684;&#x8F93;&#x51FA; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&#xD7;</mo></mrow><annotation encoding="application/x-tex">\\times</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord">&#xD7;</span></span></span></span> &#x5206;&#x652F; 2 &#x7684;&#x8F93;&#x51FA;&#x3002;&#x8FD9;&#x7C7B;&#x4F3C;&#x4E8E; <strong>SwiGLU</strong> &#x7ED3;&#x6784;&#x3002;</li>
<li><strong>&#x8F93;&#x51FA;&#x6295;&#x5F71;</strong>&#xFF1A;&#x7EF4;&#x5EA6;&#x53D8;&#x56DE; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>&#x3002;</li>
</ol>
<p><strong>&#x5BF9;&#x6BD4;&#x7ED3;&#x8BBA;&#xFF1A;</strong> Mamba &#x628A; Transformer &#x4E2D;&#x7684; Attention &#x6362;&#x6210;&#x4E86; SSM&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x5D4C;&#x5165;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x95E8;&#x63A7; MLP &#x7684;&#x7ED3;&#x6784;&#x4E2D;&#x3002;</p>
<hr>
<h2 id="4. &#x6838;&#x5FC3;&#x6570;&#x5B66;&#x539F;&#x7406;&#xFF1A;&#x4ECE;&#x6700;&#x5C0F;&#x5B9E;&#x73B0;&#x9010;&#x5C42;&#x5806;&#x53E0;"><a href="#4. &#x6838;&#x5FC3;&#x6570;&#x5B66;&#x539F;&#x7406;&#xFF1A;&#x4ECE;&#x6700;&#x5C0F;&#x5B9E;&#x73B0;&#x9010;&#x5C42;&#x5806;&#x53E0;"></a>4. &#x6838;&#x5FC3;&#x6570;&#x5B66;&#x539F;&#x7406;&#xFF1A;&#x4ECE;&#x6700;&#x5C0F;&#x5B9E;&#x73B0;&#x9010;&#x5C42;&#x5806;&#x53E0;</h2>
<p>&#x7406;&#x89E3; Mamba &#x7684;&#x6700;&#x4F73;&#x8DEF;&#x5F84;&#x662F;<strong>&#x4ECE;&#x6700;&#x7B80;&#x5355;&#x7684;&#x4EE3;&#x7801;&#x5F00;&#x59CB;&#xFF0C;&#x4E00;&#x5C42;&#x5C42;&#x6DFB;&#x52A0;&#x529F;&#x80FD;</strong>&#x3002;&#x8FD9;&#x6BD4;&#x76F4;&#x63A5;&#x770B;&#x516C;&#x5F0F;&#x66F4;&#x5BB9;&#x6613;&#x5EFA;&#x7ACB;&#x76F4;&#x89C9;&#x3002;</p>
<h3 id="&#x7B2C;&#x4E00;&#x5C42;&#xFF1A;&#x6700;&#x5C0F; SSM &#x2014;&#x2014; 5 &#x884C;&#x4EE3;&#x7801;"><a href="#&#x7B2C;&#x4E00;&#x5C42;&#xFF1A;&#x6700;&#x5C0F; SSM &#x2014;&#x2014; 5 &#x884C;&#x4EE3;&#x7801;"></a>&#x7B2C;&#x4E00;&#x5C42;&#xFF1A;&#x6700;&#x5C0F; SSM &#x2014;&#x2014; 5 &#x884C;&#x4EE3;&#x7801;</h3>
<p>&#x5FD8;&#x6389;&#x6240;&#x6709;&#x590D;&#x6742;&#x7684;&#x4E1C;&#x897F;&#x3002;SSM &#x7684;&#x6838;&#x5FC3;&#x5C31;&#x662F;<strong>&#x4E00;&#x9636;&#x7EBF;&#x6027;&#x9012;&#x5F52;</strong>&#xFF1A;</p>
<pre><code class="language-python"><span class="hljs-comment"># &#x6700;&#x5C0F; SSM&#xFF1A;&#x4E00;&#x7EF4;&#x8F93;&#x5165;&#xFF0C;&#x4E00;&#x7EF4;&#x72B6;&#x6001;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">minimal_ssm</span>(<span class="hljs-params">x, a, b, c</span>):</span>
    <span class="hljs-string">&quot;&quot;&quot;
    x: &#x8F93;&#x5165;&#x5E8F;&#x5217; [L]
    a, b, c: &#x6807;&#x91CF;&#x53C2;&#x6570;
    &quot;&quot;&quot;</span>
    h = <span class="hljs-number">0</span>  <span class="hljs-comment"># &#x72B6;&#x6001;&#xFF0C;&#x521D;&#x59CB;&#x4E3A; 0</span>
    y = []
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x)):
        h = a * h + b * x[t]  <span class="hljs-comment"># &#x72B6;&#x6001;&#x66F4;&#x65B0;</span>
        y.append(c * h)       <span class="hljs-comment"># &#x8F93;&#x51FA;</span>
    <span class="hljs-keyword">return</span> y
</code></pre>
<p><strong>&#x56DE;&#x7B54;&#x4E09;&#x4E2A;&#x6838;&#x5FC3;&#x95EE;&#x9898;&#xFF1A;</strong></p>
<table>
<thead>
<tr>
<th>&#x95EE;&#x9898;</th>
<th>&#x7B54;&#x6848;</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>State &#x662F;&#x4EC0;&#x4E48;&#xFF1F;</strong></td>
<td><code>h</code>&#xFF0C;&#x4E00;&#x4E2A;&#x6807;&#x91CF;&#xFF0C;&#x4EE3;&#x8868;&quot;&#x5BF9;&#x5386;&#x53F2;&#x7684;&#x538B;&#x7F29;&#x8BB0;&#x5FC6;&quot;</td>
</tr>
<tr>
<td><strong>&#x600E;&#x4E48; Update&#xFF1F;</strong></td>
<td><code>h_new = a * h_old + b * x_t</code>&#xFF08;&#x65E7;&#x8BB0;&#x5FC6; &#xD7; &#x8870;&#x51CF; + &#x65B0;&#x8F93;&#x5165; &#xD7; &#x6743;&#x91CD;&#xFF09;</td>
</tr>
<tr>
<td><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5E76;&#x884C;&#xFF1F;</strong></td>
<td>&#x8FD8;&#x4E0D;&#x80FD;&#xFF01;&#x8FD9;&#x662F;&#x4E32;&#x884C;&#x7684;&#x3002;&#x4F46;&#x9A6C;&#x4E0A;&#x89E3;&#x51B3;&#x3002;</td>
</tr>
</tbody>
</table>
<p><strong>&#x516C;&#x5F0F;&#xFF1A;</strong>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mi>a</mi><mo>&#x22C5;</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mspace width="1em"/><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>c</mi><mo>&#x22C5;</mo><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = a \\cdot h_{t-1} + b \\cdot x_t, \\quad y_t = c \\cdot h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<hr>
<h3 id="&#x7B2C;&#x4E8C;&#x5C42;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5E76;&#x884C;&#xFF1F;&#x2014;&#x2014; &#x5173;&#x8054;&#x5F8B;&#x7684;&#x9B54;&#x6CD5;"><a href="#&#x7B2C;&#x4E8C;&#x5C42;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5E76;&#x884C;&#xFF1F;&#x2014;&#x2014; &#x5173;&#x8054;&#x5F8B;&#x7684;&#x9B54;&#x6CD5;"></a>&#x7B2C;&#x4E8C;&#x5C42;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5E76;&#x884C;&#xFF1F;&#x2014;&#x2014; &#x5173;&#x8054;&#x5F8B;&#x7684;&#x9B54;&#x6CD5;</h3>
<p>&#x4E32;&#x884C;&#x9012;&#x5F52;&#x770B;&#x8D77;&#x6765;&#x4E0D;&#x80FD;&#x5E76;&#x884C;&#xFF0C;&#x4F46;&#x6570;&#x5B66;&#x4E0A;&#x6709;&#x4E2A;&#x6280;&#x5DE7;&#xFF1A;<strong>&#x7EBF;&#x6027;&#x9012;&#x5F52;&#x53EF;&#x4EE5;&#x5C55;&#x5F00;&#x6210;&#x52A0;&#x6743;&#x548C;</strong>&#x3002;</p>
<p>&#x5C55;&#x5F00;&#x9012;&#x5F52;&#xFF1A;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>h</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><mi>a</mi><mo>&#x22C5;</mo><msub><mi>h</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>h</mi><mn>2</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><msup><mi>a</mi><mn>2</mn></msup><msub><mi>h</mi><mn>0</mn></msub><mo>+</mo><mi>a</mi><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msub><mi>h</mi><mn>3</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow/><mo>=</mo><msup><mi>a</mi><mn>3</mn></msup><msub><mi>h</mi><mn>0</mn></msub><mo>+</mo><msup><mi>a</mi><mn>2</mn></msup><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mi>a</mi><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi>b</mi><mo>&#x22C5;</mo><msub><mi>x</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\\begin{aligned}
h_1 &amp;= a \\cdot h_0 + b \\cdot x_1 \\
h_2 &amp;= a^2 h_0 + ab \\cdot x_1 + b \\cdot x_2 \\
h_3 &amp;= a^3 h_0 + a^2 b \\cdot x_1 + ab \\cdot x_2 + b \\cdot x_3
\\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.5482em;vertical-align:-2.0241em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5241em;"><span style="top:-4.6841em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6359em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.0241em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5241em;"><span style="top:-4.6841em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">ab</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6359em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">ab</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:2.0241em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>&#x53D1;&#x73B0;&#x4E86;&#x5417;&#xFF1F;<strong>&#x8F93;&#x51FA;&#x662F;&#x8F93;&#x5165;&#x7684;&#x52A0;&#x6743;&#x548C;</strong>&#xFF0C;&#x6743;&#x91CD;&#x662F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> &#x7684;&#x5E42;&#x6B21;&#xFF01;&#x8FD9;&#x7B49;&#x4EF7;&#x4E8E;&#x4E00;&#x4E2A;<strong>&#x5377;&#x79EF;</strong>&#xFF1A;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><mi>x</mi><mo>&#x2217;</mo><mover accent="true"><mi>K</mi><mo>&#x2C9;</mo></mover><mo separator="true">,</mo><mspace width="1em"/><mover accent="true"><mi>K</mi><mo>&#x2C9;</mo></mover><mo>=</mo><mo stretchy="false">[</mo><mi>c</mi><mi>b</mi><mo separator="true">,</mo><mi>c</mi><mi>a</mi><mi>b</mi><mo separator="true">,</mo><mi>c</mi><msup><mi>a</mi><mn>2</mn></msup><mi>b</mi><mo separator="true">,</mo><mo>&#x2026;</mo><mtext>&#x2009;</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">y = x * \\bar{K}, \\quad \\bar{K} = [cb, cab, ca^2b, \\dots]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x2217;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1944em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1141em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">c</span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">ab</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">&#x2026;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mclose">]</span></span></span></span></span></p>
<pre><code class="language-python"><span class="hljs-comment"># &#x5E76;&#x884C;&#x7248;&#x672C;&#xFF08;&#x5377;&#x79EF;&#x5F62;&#x5F0F;&#xFF09;&#x2014;&#x2014; &#x8BAD;&#x7EC3;&#x65F6;&#x7528;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parallel_ssm</span>(<span class="hljs-params">x, a, b, c</span>):</span>
    L = <span class="hljs-built_in">len</span>(x)
    K = [c * b * (a ** i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(L)]  <span class="hljs-comment"># &#x6784;&#x9020;&#x5377;&#x79EF;&#x6838;</span>
    <span class="hljs-keyword">return</span> convolve(x, K)  <span class="hljs-comment"># &#x5377;&#x79EF; = &#x5E76;&#x884C;&#xFF01;</span>
</code></pre>
<p><strong>&#x4F46;&#x8FD9;&#x6709;&#x4E2A;&#x81F4;&#x547D;&#x524D;&#x63D0;&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a, b, c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span> &#x5FC5;&#x987B;&#x662F;&#x5E38;&#x6570;&#xFF01;</strong></p>
<p>&#x5982;&#x679C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a, b, c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span> &#x968F;&#x65F6;&#x95F4;&#x53D8;&#x5316;&#xFF08;&#x9009;&#x62E9;&#x6027;&#xFF09;&#xFF0C;&#x5377;&#x79EF;&#x5F62;&#x5F0F;&#x5C31;&#x5931;&#x6548;&#x4E86;&#x3002;&#x8FD9;&#x5C31;&#x662F; Mamba &#x7684;&#x6280;&#x672F;&#x6311;&#x6218;&#x3002;</p>
<hr>
<h3 id="&#x7B2C;&#x4E8C;&#x5C42;&#x534A;&#xFF1A;&#x79BB;&#x6563;&#x5316; &#x2014;&#x2014; &#x394;\\Delta&#x394; &#x4ECE;&#x4F55;&#x800C;&#x6765;&#xFF1F;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; a,ba, ba,b&#xFF1F;"><a href="#&#x7B2C;&#x4E8C;&#x5C42;&#x534A;&#xFF1A;&#x79BB;&#x6563;&#x5316; &#x2014;&#x2014; &#x394;\\Delta&#x394; &#x4ECE;&#x4F55;&#x800C;&#x6765;&#xFF1F;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; a,ba, ba,b&#xFF1F;"></a>&#x7B2C;&#x4E8C;&#x5C42;&#x534A;&#xFF1A;&#x79BB;&#x6563;&#x5316; &#x2014;&#x2014; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x4ECE;&#x4F55;&#x800C;&#x6765;&#xFF1F;&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span>&#xFF1F;</h3>
<p>&#x5728;&#x4E0A;&#x9762;&#x7684;&#x6700;&#x5C0F;&#x5B9E;&#x73B0;&#x4E2D;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span> &#x662F;&#x76F4;&#x63A5;&#x5B66;&#x4E60;&#x7684;&#x53C2;&#x6570;&#x3002;&#x4F46; Mamba&#xFF08;&#x4EE5;&#x53CA;&#x4E4B;&#x524D;&#x7684; S4&#xFF09;<strong>&#x5E76;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x5B66; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">a, b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span></span></span></span></strong>&#xFF0C;&#x800C;&#x662F;&#x5148;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;<strong>&#x8FDE;&#x7EED;&#x65F6;&#x95F4;&#x7CFB;&#x7EDF;</strong>&#xFF0C;&#x518D;&#x901A;&#x8FC7; <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span></strong> &#x628A;&#x5B83;&quot;&#x79BB;&#x6563;&#x5316;&quot;&#x6210; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover></mrow><annotation encoding="application/x-tex">\\bar{A}, \\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span></span></span></span>&#x3002;</p>
<p><strong>&#x8FD9;&#x4E0D;&#x662F;&#x6545;&#x5F04;&#x7384;&#x865A;&#xFF0C;&#x800C;&#x662F;&#x6709;&#x575A;&#x5B9E;&#x7684;&#x7406;&#x8BBA;&#x652F;&#x6491;&#x548C;&#x5B9E;&#x9645;&#x6536;&#x76CA;&#x7684;&#x3002;</strong></p>
<h4 id="&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7ED5;&#x8FD9;&#x4E00;&#x5708;&#xFF1F;&#x2014;&#x2014; &#x4ECE;&#x7269;&#x7406;&#x4E16;&#x754C;&#x5230;&#x6570;&#x5B57;&#x4E16;&#x754C;"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7ED5;&#x8FD9;&#x4E00;&#x5708;&#xFF1F;&#x2014;&#x2014; &#x4ECE;&#x7269;&#x7406;&#x4E16;&#x754C;&#x5230;&#x6570;&#x5B57;&#x4E16;&#x754C;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x7ED5;&#x8FD9;&#x4E00;&#x5708;&#xFF1F;&#x2014;&#x2014; &#x4ECE;&#x7269;&#x7406;&#x4E16;&#x754C;&#x5230;&#x6570;&#x5B57;&#x4E16;&#x754C;</h4>
<p>SSM &#x7684;&#x6570;&#x5B66;&#x6839;&#x57FA;&#x6765;&#x81EA;<strong>&#x63A7;&#x5236;&#x7406;&#x8BBA;</strong>&#xFF08;Control Theory&#xFF09;&#x3002;&#x5728;&#x63A7;&#x5236;&#x7406;&#x8BBA;&#x4E2D;&#xFF0C;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x52A8;&#x6001;&#x7CFB;&#x7EDF;&#x7684;&#x6807;&#x51C6;&#x65B9;&#x5F0F;&#x662F;<strong>&#x5FAE;&#x5206;&#x65B9;&#x7A0B;</strong>&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">&#x2032;</mo></msup><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mo>&#x22C5;</mo><mi>h</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>B</mi><mo>&#x22C5;</mo><mi>x</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h&apos;(t) = A \\cdot h(t) + B \\cdot x(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0519em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2032;</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span></p>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;<strong>&#x8FDE;&#x7EED;&#x65F6;&#x95F4;</strong>&#x7CFB;&#x7EDF; &#x2014;&#x2014; &#x65F6;&#x95F4; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> &#x662F;&#x8FDE;&#x7EED;&#x6D41;&#x52A8;&#x7684;&#xFF08;&#x50CF;&#x73B0;&#x5B9E;&#x4E16;&#x754C;&#x7684;&#x6E29;&#x5EA6;&#x53D8;&#x5316;&#x3001;&#x6C7D;&#x8F66;&#x901F;&#x5EA6;&#xFF09;&#x3002;</p>
<p>&#x4F46;&#x8BA1;&#x7B97;&#x673A;&#x5904;&#x7406;&#x7684;&#x662F;<strong>&#x79BB;&#x6563;&#x5E8F;&#x5217;</strong>&#xFF08;&#x4E00;&#x4E2A;&#x4E2A; Token&#xFF09;&#x3002;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x628A;&#x8FDE;&#x7EED;&#x7CFB;&#x7EDF;&quot;&#x91C7;&#x6837;&quot;&#x6210;&#x79BB;&#x6563;&#x7684;&#x6B65;&#x9AA4;&#x3002;&#x8FD9;&#x5C31;&#x662F;<strong>&#x79BB;&#x6563;&#x5316;&#xFF08;Discretization&#xFF09;</strong> &#x7684;&#x4F5C;&#x7528;&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>=</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover><mo>&#x2248;</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\\bar{A} = \\exp(\\Delta \\cdot A), \\quad \\bar{B} \\approx \\Delta \\cdot B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0701em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p>&#x5176;&#x4E2D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x5C31;&#x662F;<strong>&#x91C7;&#x6837;&#x95F4;&#x9694;</strong>&#xFF08;&quot;&#x4E24;&#x6B21;&#x89C2;&#x6D4B;&#x4E4B;&#x95F4;&#x9694;&#x4E86;&#x591A;&#x4E45;&quot;&#xFF09;&#x3002;</p>
<h4 id="&#x394;\\Delta&#x394; &#x7684;&#x7269;&#x7406;&#x76F4;&#x89C9;"><a href="#&#x394;\\Delta&#x394; &#x7684;&#x7269;&#x7406;&#x76F4;&#x89C9;"></a><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x7684;&#x7269;&#x7406;&#x76F4;&#x89C9;</h4>
<p>&#x60F3;&#x8C61;&#x4F60;&#x5728;<strong>&#x770B;&#x4E00;&#x90E8;&#x7535;&#x5F71;</strong>&#xFF0C;&#x4F46;&#x4F60;&#x4E0D;&#x662F;&#x8FDE;&#x7EED;&#x770B;&#xFF0C;&#x800C;&#x662F;&#x6BCF;&#x9694;&#x4E00;&#x6BB5;&#x65F6;&#x95F4;&#x770B;&#x4E00;&#x5E27;&#x622A;&#x56FE;&#xFF1A;</p>
<ul>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x5C0F;</strong>&#xFF08;&#x6BCF; 0.1 &#x79D2;&#x770B;&#x4E00;&#x5E27;&#xFF09;&#xFF1A;&#x524D;&#x540E;&#x4E24;&#x5E27;&#x51E0;&#x4E4E;&#x4E00;&#x6837;&#xFF0C;&#x753B;&#x9762;&#x53D8;&#x5316;&#x6781;&#x5C0F; &#x2192; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>&#x2248;</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">\\bar{A} \\approx I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>&#xFF08;&#x72B6;&#x6001;&#x51E0;&#x4E4E;&#x4E0D;&#x53D8;&#xFF09;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover><mo>&#x2248;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\bar{B} \\approx 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF08;&#x65B0;&#x5E27;&#x8D21;&#x732E;&#x6781;&#x5C0F;&#xFF09;</li>
<li><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x5927;</strong>&#xFF08;&#x6BCF; 10 &#x79D2;&#x770B;&#x4E00;&#x5E27;&#xFF09;&#xFF1A;&#x524D;&#x540E;&#x4E24;&#x5E27;&#x5DEE;&#x5F02;&#x5DE8;&#x5927;&#xFF0C;&#x4E2D;&#x95F4;&#x53D1;&#x751F;&#x4E86;&#x5F88;&#x591A;&#x4E8B; &#x2192; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>&#x2248;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\bar{A} \\approx 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF08;&#x65E7;&#x72B6;&#x6001;&#x8FC7;&#x671F;&#x4E86;&#xFF09;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover></mrow><annotation encoding="application/x-tex">\\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span></span></span></span> &#x5927;&#xFF08;&#x65B0;&#x5E27;&#x6210;&#x4E3A;&#x4E3B;&#x8981;&#x4FE1;&#x606F;&#x6E90;&#xFF09;</li>
</ul>
<p><strong>&#x8FD9;&#x5C31;&#x662F;&#x4E3A;&#x4EC0;&#x4E48; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x80FD;&#x81EA;&#x7136;&#x5730;&#x63A7;&#x5236;&quot;&#x8BB0;&#x5FC6; vs &#x8F93;&#x5165;&quot;&#x7684;&#x5E73;&#x8861;</strong> &#x2014;&#x2014; &#x5B83;&#x4E0D;&#x662F;&#x4E00;&#x4E2A;&#x62CD;&#x8111;&#x888B;&#x8BBE;&#x8BA1;&#x7684;&#x95E8;&#x63A7;&#xFF0C;&#x800C;&#x662F;&#x4ECE;&#x7269;&#x7406;&#x4E16;&#x754C;&#x7684;&#x91C7;&#x6837;&#x7406;&#x8BBA;&#x4E2D;<strong>&#x81EA;&#x7136;&#x6D8C;&#x73B0;</strong>&#x7684;&#x3002;</p>
<h4 id="&#x79BB;&#x6563;&#x5316;&#x7684;&#x4E09;&#x5927;&#x6536;&#x76CA;&#xFF08;&#x4E0D;&#x662F;&#x767D;&#x7ED5;&#x7684;&#xFF01;&#xFF09;"><a href="#&#x79BB;&#x6563;&#x5316;&#x7684;&#x4E09;&#x5927;&#x6536;&#x76CA;&#xFF08;&#x4E0D;&#x662F;&#x767D;&#x7ED5;&#x7684;&#xFF01;&#xFF09;"></a>&#x79BB;&#x6563;&#x5316;&#x7684;&#x4E09;&#x5927;&#x6536;&#x76CA;&#xFF08;&#x4E0D;&#x662F;&#x767D;&#x7ED5;&#x7684;&#xFF01;&#xFF09;</h4>
<p><strong>&#x6536;&#x76CA; 1&#xFF1A;&#x7A33;&#x5B9A;&#x6027;&#x4FDD;&#x8BC1;</strong></p>
<p>&#x76F4;&#x63A5;&#x5B66;&#x4E60; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span> &#x6709;&#x4E00;&#x4E2A;&#x98CE;&#x9669;&#xFF1A;&#x5982;&#x679C; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x2223;</mi><mi>a</mi><mi mathvariant="normal">&#x2223;</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|a| &gt; 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">&#x2223;</span><span class="mord mathnormal">a</span><span class="mord">&#x2223;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>&#xFF0C;&#x72B6;&#x6001;&#x4F1A;&#x6307;&#x6570;&#x7206;&#x70B8;&#xFF08;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msup><mi>a</mi><mi>t</mi></msup><mo>&#x22C5;</mo><msub><mi>h</mi><mn>0</mn></msub><mo>&#x2192;</mo><mi mathvariant="normal">&#x221E;</mi></mrow><annotation encoding="application/x-tex">h_t = a^t \\cdot h_0 \\to \\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord">&#x221E;</span></span></span></span>&#xFF09;&#x3002;</p>
<p>&#x4F46;&#x901A;&#x8FC7;&#x79BB;&#x6563;&#x5316;&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>=</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\bar{A} = \\exp(\\Delta \\cdot A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span></span></span></span>&#xFF0C;&#x7531;&#x4E8E; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> &#x521D;&#x59CB;&#x5316;&#x4E3A;&#x8D1F;&#x6570;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\Delta &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF08;Softplus &#x4FDD;&#x8BC1;&#xFF09;&#xFF0C;&#x6240;&#x4EE5; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\Delta \\cdot A &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF0C;&#x4E8E;&#x662F;&#xFF1A;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">&#x2223;</mi><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mi mathvariant="normal">&#x2223;</mi><mo>=</mo><mi mathvariant="normal">&#x2223;</mi><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo stretchy="false">)</mo><mi mathvariant="normal">&#x2223;</mi><mo>=</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>1</mn><mspace width="1em"/><mtext>&#xFF08;&#x6C38;&#x8FDC;&#x5C0F;&#x4E8E;&#xA0;1&#xFF01;&#xFF09;</mtext></mrow><annotation encoding="application/x-tex">|\\bar{A}| = |\\exp(\\Delta \\cdot A)| = \\exp(\\Delta \\cdot A) &lt; 1 \\quad \\text{&#xFF08;&#x6C38;&#x8FDC;&#x5C0F;&#x4E8E; 1&#xFF01;&#xFF09;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0701em;vertical-align:-0.25em;"></span><span class="mord">&#x2223;</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mord">&#x2223;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">&#x2223;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mord">&#x2223;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord cjk_fallback">&#xFF08;&#x6C38;&#x8FDC;&#x5C0F;&#x4E8E;</span><span class="mord">&#xA0;1</span><span class="mord cjk_fallback">&#xFF01;&#xFF09;</span></span></span></span></span></span></p>
<p><strong>&#x72B6;&#x6001;&#x6C38;&#x8FDC;&#x4E0D;&#x4F1A;&#x7206;&#x70B8;</strong>&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x989D;&#x5916;&#x7684;&#x68AF;&#x5EA6;&#x88C1;&#x526A;&#x6216;&#x5F52;&#x4E00;&#x5316;&#x6280;&#x5DE7;&#x3002;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;<strong>&#x7ED3;&#x6784;&#x6027;&#x4FDD;&#x8BC1;</strong>&#xFF0C;&#x6BD4; LSTM &#x7684; Sigmoid &#x95E8;&#x63A7;&#x66F4;&#x4F18;&#x96C5;&#x3002;</p>
<p><strong>&#x6536;&#x76CA; 2&#xFF1A;&#x4E0E; RNN &#x95E8;&#x63A7;&#x7684;&#x7EDF;&#x4E00;</strong></p>
<p>Mamba &#x8BBA;&#x6587;&#x7684; <strong>Theorem 1</strong> &#x8BC1;&#x660E;&#x4E86;&#x4E00;&#x4E2A;&#x5173;&#x952E;&#x7B49;&#x4EF7;&#x5173;&#x7CFB;&#xFF1A;</p>
<blockquote>
<p>&#x5F53; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mi>A</mi><mo>=</mo><mo>&#x2212;</mo><mn>1</mn><mo separator="true">,</mo><mi>B</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">N=1, A=-1, B=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">&#x2212;</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> &#x65F6;&#xFF0C;Selective SSM &#x7684;&#x9012;&#x5F52;&#x516C;&#x5F0F;<strong>&#x6070;&#x597D;&#x7B49;&#x4E8E; GRU/LSTM &#x7684;&#x95E8;&#x63A7;&#x65B9;&#x7A0B;</strong>&#xFF1A;</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>g</mi><mi>t</mi></msub><mo>=</mo><mi>&#x3C3;</mi><mo stretchy="false">(</mo><mtext>Linear</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g_t = \\sigma(\\text{Linear}(x_t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord text"><span class="mord">Linear</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span></span>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>&#x2212;</mo><msub><mi>g</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo>&#x22C5;</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>g</mi><mi>t</mi></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = (1 - g_t) \\cdot h_{t-1} + g_t \\cdot x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x2212;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
</blockquote>
<p>&#x8FD9;&#x610F;&#x5473;&#x7740;&#xFF1A;</p>
<ul>
<li>LSTM/GRU &#x7684;&#x95E8;&#x63A7;&#x662F;<strong>&#x62CD;&#x8111;&#x888B;&#x8BBE;&#x8BA1;&#x7684;&#x542F;&#x53D1;&#x5F0F;&#x65B9;&#x6CD5;</strong>&#xFF08;&quot;&#x611F;&#x89C9; Sigmoid &#x95E8;&#x80FD;&#x63A7;&#x5236;&#x4FE1;&#x606F;&#x6D41;&quot;&#xFF09;&#x3002;</li>
<li>Mamba &#x7684; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x662F;&#x4ECE;<strong>&#x8FDE;&#x7EED;&#x52A8;&#x529B;&#x7CFB;&#x7EDF;&#x7684;&#x79BB;&#x6563;&#x5316;&#x4E2D;&#x63A8;&#x5BFC;&#x51FA;&#x6765;&#x7684;</strong>&#xFF0C;&#x7136;&#x540E;&#x6070;&#x597D;&#x9000;&#x5316;&#x6210;&#x4E86;&#x95E8;&#x63A7;&#x3002;</li>
</ul>
<p>&#x6362;&#x53E5;&#x8BDD;&#x8BF4;&#xFF1A;<strong>LSTM &#x7684;&#x95E8;&#x63A7;&#x53EA;&#x662F; SSM &#x79BB;&#x6563;&#x5316;&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x4F8B;</strong>&#x3002;Mamba &#x627E;&#x5230;&#x4E86;&#x95E8;&#x63A7;&#x673A;&#x5236;&#x7684;<strong>&#x7406;&#x8BBA;&#x6839;&#x57FA;</strong>&#x3002;</p>
<p><strong>&#x6536;&#x76CA; 3&#xFF1A;&#x5206;&#x8FA8;&#x7387;&#x4E0D;&#x53D8;&#x6027;&#xFF08;Resolution Invariance&#xFF09;</strong></p>
<p>&#x56E0;&#x4E3A;&#x5E95;&#x5C42;&#x662F;&#x8FDE;&#x7EED;&#x7CFB;&#x7EDF;&#xFF0C;&#x53EA;&#x662F;&#x7528; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x6765;&#x91C7;&#x6837;&#xFF0C;&#x6240;&#x4EE5;&#xFF1A;</p>
<ul>
<li>&#x8BAD;&#x7EC3;&#x65F6;&#x7528; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\\Delta = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>&#xFF08;&#x6BCF;&#x4E2A; Token &#x95F4;&#x9694; 1&#xFF09;&#x3002;</li>
<li>&#x63A8;&#x7406;&#x65F6;&#x53EF;&#x4EE5;&#x6539;&#x6210; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\\Delta = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span></span></span></span>&#xFF08;&#x66F4;&#x7EC6;&#x7C92;&#x5EA6;&#xFF09;&#x6216; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\\Delta = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span>&#xFF08;&#x66F4;&#x7C97;&#x7C92;&#x5EA6;&#xFF09;&#x3002;</li>
<li>&#x6A21;&#x578B;&#x5BF9;&#x4E0D;&#x540C;&quot;&#x91C7;&#x6837;&#x7387;&quot;&#x7684;&#x6570;&#x636E;&#x5177;&#x6709;&#x5929;&#x7136;&#x7684;&#x6CDB;&#x5316;&#x80FD;&#x529B;&#x3002;</li>
</ul>
<p>&#x8FD9;&#x5BF9;<strong>&#x97F3;&#x9891;</strong>&#xFF08;&#x91C7;&#x6837;&#x7387;&#x53EF;&#x80FD;&#x662F; 16kHz &#x6216; 44.1kHz&#xFF09;&#x548C;<strong>&#x65F6;&#x5E8F;&#x6570;&#x636E;</strong>&#x7279;&#x522B;&#x6709;&#x7528;&#x3002;</p>
<h4 id="&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; A&#x2C9;,B&#x2C9;\\bar{A}, \\bar{B}A&#x2C9;,B&#x2C9;&#xFF1F;"><a href="#&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; A&#x2C9;,B&#x2C9;\\bar{A}, \\bar{B}A&#x2C9;,B&#x2C9;&#xFF1F;"></a>&#x4E3A;&#x4EC0;&#x4E48;&#x4E0D;&#x76F4;&#x63A5;&#x5B66; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover></mrow><annotation encoding="application/x-tex">\\bar{A}, \\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span></span></span></span>&#xFF1F;</h4>
<p>&#x8BBA;&#x6587;&#x4E5F;&#x63D0;&#x5230;&#x4E86;&#xFF0C;&#x4F60;<strong>&#x53EF;&#x4EE5;</strong>&#x76F4;&#x63A5;&#x53C2;&#x6570;&#x5316; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo separator="true">,</mo><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover></mrow><annotation encoding="application/x-tex">\\bar{A}, \\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span></span></span></span>&#xFF0C;&#x8DF3;&#x8FC7;&#x79BB;&#x6563;&#x5316;&#x3002;&#x4F46;&#x4F60;&#x4F1A;&#x5931;&#x53BB;&#x4E0A;&#x9762;&#x7684;&#x4E09;&#x4E2A;&#x6536;&#x76CA;&#xFF1A;</p>
<ul>
<li>&#x6CA1;&#x6709;&#x7A33;&#x5B9A;&#x6027;&#x4FDD;&#x8BC1;&#xFF08;&#x9700;&#x8981;&#x624B;&#x52A8; clip&#xFF09;</li>
<li>&#x6CA1;&#x6709;&#x4E0E;&#x8FDE;&#x7EED;&#x7CFB;&#x7EDF;&#x7684;&#x8054;&#x7CFB;&#xFF08;&#x5931;&#x53BB;&#x7406;&#x8BBA;&#x6839;&#x57FA;&#xFF09;</li>
<li>&#x6CA1;&#x6709;&#x5206;&#x8FA8;&#x7387;&#x4E0D;&#x53D8;&#x6027;</li>
</ul>
<p><strong>&#x603B;&#x7ED3;&#xFF1A;&#x79BB;&#x6563;&#x5316;&#x4E0D;&#x662F;&#x591A;&#x4F59;&#x7684;&#x4EEA;&#x5F0F;&#xFF0C;&#x800C;&#x662F;&#x628A;&quot;&#x7269;&#x7406;&#x4E16;&#x754C;&#x7684;&#x7ED3;&#x6784;&#x5148;&#x9A8C;&quot;&#x6CE8;&#x5165;&#x5230;&#x4E86;&#x7F51;&#x7EDC;&#x53C2;&#x6570;&#x4E2D;&#x3002;</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x4E4B;&#x6240;&#x4EE5;&#x80FD;&#x6210;&#x4E3A;&quot;&#x9009;&#x62E9;&#x6027;&quot;&#x7684;&#x6838;&#x5FC3;&#x65CB;&#x94AE;&#xFF0C;&#x6B63;&#x662F;&#x56E0;&#x4E3A;&#x5B83;&#x5728;&#x7269;&#x7406;&#x4E0A;&#x4EE3;&#x8868;&quot;&#x4E24;&#x6B21;&#x89C2;&#x6D4B;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&quot; &#x2014;&#x2014; &#x95F4;&#x9694;&#x5927;&#x5C31;&#x610F;&#x5473;&#x7740;&quot;&#x8FD9;&#x6BB5;&#x4FE1;&#x606F;&#x5F88;&#x91CD;&#x8981;&#xFF0C;&#x8981;&#x4ED4;&#x7EC6;&#x770B;&quot;&#xFF0C;&#x95F4;&#x9694;&#x5C0F;&#x5C31;&#x610F;&#x5473;&#x7740;&quot;&#x548C;&#x4E0A;&#x4E00;&#x5E27;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x8DF3;&#x8FC7;&quot;&#x3002;</p>
<hr>
<h3 id="&#x7B2C;&#x4E09;&#x5C42;&#xFF1A;&#x9009;&#x62E9;&#x6027; &#x2014;&#x2014; &#x8BA9;&#x53C2;&#x6570;&#x52A8;&#x6001;&#x53D8;&#x5316;"><a href="#&#x7B2C;&#x4E09;&#x5C42;&#xFF1A;&#x9009;&#x62E9;&#x6027; &#x2014;&#x2014; &#x8BA9;&#x53C2;&#x6570;&#x52A8;&#x6001;&#x53D8;&#x5316;"></a>&#x7B2C;&#x4E09;&#x5C42;&#xFF1A;&#x9009;&#x62E9;&#x6027; &#x2014;&#x2014; &#x8BA9;&#x53C2;&#x6570;&#x52A8;&#x6001;&#x53D8;&#x5316;</h3>
<p>&#x4F20;&#x7EDF; SSM &#x7684;&#x95EE;&#x9898;&#xFF1A;<strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a, b, c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span> &#x662F;&#x56FA;&#x5B9A;&#x7684;</strong>&#xFF0C;&#x5BF9;&#x6240;&#x6709;&#x8F93;&#x5165;&#x4E00;&#x89C6;&#x540C;&#x4EC1;&#x3002;</p>
<pre><code class="language-python"><span class="hljs-comment"># &#x4F20;&#x7EDF; SSM&#xFF08;LTI&#xFF09;&#x2014;&#x2014; &#x53C2;&#x6570;&#x56FA;&#x5B9A;</span>
h = a * h + b * x[t]  <span class="hljs-comment"># a, b &#x56FA;&#x5B9A;&#xFF0C;&#x4E0D;&#x7BA1; x[t] &#x662F;&#x5565;</span>
</code></pre>
<p><strong>Mamba &#x7684;&#x6539;&#x8FDB;&#xFF1A;&#x8BA9; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo separator="true">,</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">a, b, c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">c</span></span></span></span> &#x6210;&#x4E3A; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x7684;&#x51FD;&#x6570;&#xFF01;</strong></p>
<pre><code class="language-python"><span class="hljs-comment"># Mamba&#xFF08;Selective SSM&#xFF09;&#x2014;&#x2014; &#x53C2;&#x6570;&#x7531;&#x8F93;&#x5165;&#x51B3;&#x5B9A;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">selective_ssm</span>(<span class="hljs-params">x, W_delta, W_b, W_c</span>):</span>
    h = <span class="hljs-number">0</span>
    y = []
    <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(x)):
        <span class="hljs-comment"># &#x5173;&#x952E;&#xFF1A;&#x53C2;&#x6570;&#x7531;&#x8F93;&#x5165;&#x51B3;&#x5B9A;&#xFF01;</span>
        delta_t = softplus(W_delta @ x[t])  <span class="hljs-comment"># &#x52A8;&#x6001;&#x6B65;&#x957F;</span>
        a_t = exp(-delta_t)                 <span class="hljs-comment"># &#x52A8;&#x6001;&#x8870;&#x51CF;&#x7387;</span>
        b_t = delta_t * (W_b @ x[t])        <span class="hljs-comment"># &#x52A8;&#x6001;&#x8F93;&#x5165;&#x6743;&#x91CD;</span>
        c_t = W_c @ x[t]                    <span class="hljs-comment"># &#x52A8;&#x6001;&#x8F93;&#x51FA;&#x6743;&#x91CD;</span>
        
        h = a_t * h + b_t * x[t]  <span class="hljs-comment"># &#x9009;&#x62E9;&#x6027;&#x66F4;&#x65B0;</span>
        y.append(c_t * h)
    <span class="hljs-keyword">return</span> y
</code></pre>
<p><strong>&#x76F4;&#x89C9;&#xFF1A;</strong></p>
<ul>
<li>&#x5F53; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x662F;&quot;&#x91CD;&#x8981; Token&quot;&#xFF08;&#x5982;&#x4EBA;&#x540D;&#xFF09;&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi></mrow><annotation encoding="application/x-tex">\\Delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span></span></span></span> &#x53D8;&#x5927; &#x2192; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">b_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x53D8;&#x5927; &#x2192; <strong>&#x4FE1;&#x606F;&#x5927;&#x7B14;&#x5199;&#x5165;&#x72B6;&#x6001;</strong>&#x3002;</li>
<li>&#x5F53; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x662F;&quot;&#x5E9F;&#x8BDD;&quot;&#xFF08;&#x5982;&quot;&#x55EF;&quot;&#x3001;&quot;&#x5443;&quot;&#xFF09;&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\Delta \\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> &#x2192; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>t</mi></msub><mo>&#x2192;</mo><mn>1</mn><mo separator="true">,</mo><msub><mi>b</mi><mi>t</mi></msub><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">a_t \\to 1, b_t \\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> &#x2192; <strong>&#x72B6;&#x6001;&#x4FDD;&#x6301;&#x4E0D;&#x53D8;&#xFF0C;&#x5FFD;&#x7565;&#x8F93;&#x5165;</strong>&#x3002;</li>
</ul>
<p><strong>&#x8FD9;&#x5C31;&#x662F;&quot;&#x9009;&#x62E9;&#x6027;&quot;&#x7684;&#x5168;&#x90E8;&#x542B;&#x4E49;&#xFF1A;&#x6A21;&#x578B;&#x5B66;&#x4F1A;&#x4E86;&quot;&#x4EC0;&#x4E48;&#x8BE5;&#x8BB0;&#xFF0C;&#x4EC0;&#x4E48;&#x8BE5;&#x5FD8;&quot;&#x3002;</strong></p>
<hr>
<h3 id="&#x7B2C;&#x56DB;&#x5C42;&#xFF1A;&#x5E76;&#x884C;&#x626B;&#x63CF; &#x2014;&#x2014; &#x5728;&#x9009;&#x62E9;&#x6027;&#x4E0B;&#x6062;&#x590D;&#x5E76;&#x884C;"><a href="#&#x7B2C;&#x56DB;&#x5C42;&#xFF1A;&#x5E76;&#x884C;&#x626B;&#x63CF; &#x2014;&#x2014; &#x5728;&#x9009;&#x62E9;&#x6027;&#x4E0B;&#x6062;&#x590D;&#x5E76;&#x884C;"></a>&#x7B2C;&#x56DB;&#x5C42;&#xFF1A;&#x5E76;&#x884C;&#x626B;&#x63CF; &#x2014;&#x2014; &#x5728;&#x9009;&#x62E9;&#x6027;&#x4E0B;&#x6062;&#x590D;&#x5E76;&#x884C;</h3>
<p>&#x9009;&#x62E9;&#x6027;&#x7834;&#x574F;&#x4E86;&#x5377;&#x79EF;&#x5F62;&#x5F0F;&#xFF0C;&#x4F46;&#x8FD8;&#x6709;&#x6551;&#xFF01;</p>
<p><strong>&#x6838;&#x5FC3;&#x89C2;&#x5BDF;&#xFF1A;</strong> &#x7EBF;&#x6027;&#x9012;&#x5F52; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><msub><mi>a</mi><mi>t</mi></msub><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>b</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = a_t h_{t-1} + b_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x6EE1;&#x8DB3;<strong>&#x5173;&#x8054;&#x5F8B;</strong>&#x3002;</p>
<p><strong>&#x7C7B;&#x6BD4;&#x524D;&#x7F00;&#x548C;&#xFF1A;</strong></p>
<ul>
<li><strong>&#x4E32;&#x884C;</strong>&#xFF1A;<code>sum[0], sum[0]+x[1], sum[0]+x[1]+x[2], ...</code> &#x9700;&#x8981; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x6B65;&#x3002;</li>
<li><strong>&#x5E76;&#x884C;</strong>&#xFF1A;&#x7528;&#x6811;&#x72B6;&#x5F52;&#x7EA6;&#xFF0C;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>&#x2061;</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\\log N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> &#x5B8C;&#x6210;&#x3002;</li>
</ul>
<pre><code>&#x539F;&#x59CB;&#x6570;&#x636E;:   [1, 2, 3, 4, 5, 6, 7, 8]
           
&#x7B2C;&#x4E00;&#x8F6E;:     [1+2]  [3+4]  [5+6]  [7+8]   (&#x5E76;&#x884C;&#x8BA1;&#x7B97; 4 &#x4E2A;&#x52A0;&#x6CD5;)
              &#x2193;      &#x2193;      &#x2193;      &#x2193;
           = [3]   [7]   [11]  [15]

&#x7B2C;&#x4E8C;&#x8F6E;:     [3+7]        [11+15]         (&#x5E76;&#x884C;&#x8BA1;&#x7B97; 2 &#x4E2A;&#x52A0;&#x6CD5;)
              &#x2193;              &#x2193;
           = [10]         [26]

&#x7B2C;&#x4E09;&#x8F6E;:     [10+26]                       (&#x5E76;&#x884C;&#x8BA1;&#x7B97; 1 &#x4E2A;&#x52A0;&#x6CD5;)
              &#x2193;
           = [36]

&#x603B;&#x8BA1;: log&#x2082;(8) = 3 &#x8F6E;&#xFF0C;&#x800C;&#x4E0D;&#x662F;&#x4E32;&#x884C;&#x7684; 7 &#x6B65;
</code></pre>
<p><strong>Mamba &#x7528;&#x540C;&#x6837;&#x7684;&#x601D;&#x8DEF;&#x5E76;&#x884C;&#x5316;&#x9012;&#x5F52;&#xFF1A;</strong></p>
<pre><code class="language-python"><span class="hljs-comment"># &#x5E76;&#x884C;&#x626B;&#x63CF;&#xFF08;&#x4F2A;&#x4EE3;&#x7801;&#xFF09;</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">parallel_scan</span>(<span class="hljs-params">a, b_x</span>):</span>
    <span class="hljs-string">&quot;&quot;&quot;
    a: [L] &#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x7684;&#x8870;&#x51CF;&#x7CFB;&#x6570;
    b_x: [L] &#x6BCF;&#x4E2A;&#x65F6;&#x523B;&#x7684;&#x8F93;&#x5165;&#x8D21;&#x732E; (b * x)
    &#x8FD4;&#x56DE;: &#x6240;&#x6709;&#x65F6;&#x523B;&#x7684;&#x72B6;&#x6001; h
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x5B9A;&#x4E49;&#x53EF;&#x7ED3;&#x5408;&#x7684;&#x4E8C;&#x5143;&#x8FD0;&#x7B97;</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">combine</span>(<span class="hljs-params">left, right</span>):</span>
        <span class="hljs-comment"># (a_left, h_left) &#x2297; (a_right, h_right)</span>
        <span class="hljs-keyword">return</span> (a_left * a_right, a_right * h_left + h_right)
    
    <span class="hljs-comment"># O(log L) &#x8F6E;&#x5E76;&#x884C;&#x5F52;&#x7EA6;</span>
    <span class="hljs-keyword">return</span> associative_scan(combine, (a, b_x))
</code></pre>
<p><strong>&#x590D;&#x6742;&#x5EA6;&#x5BF9;&#x6BD4;&#xFF1A;</strong></p>
<table>
<thead>
<tr>
<th>&#x65B9;&#x6CD5;</th>
<th>&#x65F6;&#x95F4;&#x590D;&#x6742;&#x5EA6;</th>
<th>&#x5E76;&#x884C;&#x5EA6;</th>
</tr>
</thead>
<tbody>
<tr>
<td>&#x4E32;&#x884C;&#x9012;&#x5F52;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span></td>
<td>1</td>
</tr>
<tr>
<td>&#x5E76;&#x884C;&#x626B;&#x63CF;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span> &#x603B;&#x5DE5;&#x4F5C;&#x91CF;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>L</mi><mi mathvariant="normal">/</mi><mi>log</mi><mo>&#x2061;</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(L / \\log L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal">L</span><span class="mord">/</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span> &#x5E76;&#x884C;&#x5EA6;</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="&#x7B2C;&#x4E94;&#x5C42;&#xFF1A;&#x5B8C;&#x6574; Mamba Block"><a href="#&#x7B2C;&#x4E94;&#x5C42;&#xFF1A;&#x5B8C;&#x6574; Mamba Block"></a>&#x7B2C;&#x4E94;&#x5C42;&#xFF1A;&#x5B8C;&#x6574; Mamba Block</h3>
<p>&#x628A;&#x4E0A;&#x9762;&#x7684;&#x4E1C;&#x897F;&#x7EC4;&#x88C5;&#x8D77;&#x6765;&#xFF0C;&#x52A0;&#x4E0A;&#x5DE5;&#x7A0B;&#x4F18;&#x5316;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165; x [B, L, D]
    &#x2502;
    &#x25BC;
&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502;  Linear &#x6269;&#x5C55; (D &#x2192; E*D, &#x901A;&#x5E38; E=2)          &#x2502;
&#x2502;      &#x2193;                                    &#x2502;
&#x2502;  &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;    &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;       &#x2502;
&#x2502;  &#x2502; &#x4E3B;&#x5206;&#x652F;      &#x2502;    &#x2502; &#x95E8;&#x63A7;&#x5206;&#x652F;    &#x2502;       &#x2502;
&#x2502;  &#x2502; Conv1d(4)   &#x2502;    &#x2502; SiLU        &#x2502;       &#x2502;
&#x2502;  &#x2502; SiLU        &#x2502;    &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;       &#x2502;
&#x2502;  &#x2502; Selective   &#x2502;           &#x2502;              &#x2502;
&#x2502;  &#x2502; SSM         &#x2502;           &#x2502;              &#x2502;
&#x2502;  &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;           &#x2502;              &#x2502;
&#x2502;         &#x2502;                  &#x2502;              &#x2502;
&#x2502;         &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; &#xD7; (&#x4E58;&#x6CD5;&#x878D;&#x5408;) &#x2500;&#x2500;&#x2518;            &#x2502;
&#x2502;                  &#x2502;                        &#x2502;
&#x2502;  Linear &#x538B;&#x7F29; (E*D &#x2192; D)                    &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
    &#x2502;
    &#x25BC;
&#x8F93;&#x51FA; y [B, L, D]
</code></pre>
<hr>
<h3 id="&#x6570;&#x5B66;&#x516C;&#x5F0F;&#x603B;&#x7ED3;"><a href="#&#x6570;&#x5B66;&#x516C;&#x5F0F;&#x603B;&#x7ED3;"></a>&#x6570;&#x5B66;&#x516C;&#x5F0F;&#x603B;&#x7ED3;</h3>
<p><strong>&#x79BB;&#x6563;&#x5316;&#x516C;&#x5F0F;&#xFF08;ZOH &#x65B9;&#x6CD5;&#xFF09;&#xFF1A;</strong>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>=</mo><mi>exp</mi><mo>&#x2061;</mo><mo stretchy="false">(</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>A</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover><mo>&#x2248;</mo><mi mathvariant="normal">&#x394;</mi><mo>&#x22C5;</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\\bar{A} = \\exp(\\Delta \\cdot A), \\quad \\bar{B} \\approx \\Delta \\cdot B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.0701em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></span></p>
<p><strong>&#x72B6;&#x6001;&#x66F4;&#x65B0;&#x516C;&#x5F0F;&#xFF1A;</strong>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub><mo>=</mo><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>&#x22C5;</mo><msub><mi>h</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover><mo>&#x22C5;</mo><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><mspace width="1em"/><msub><mi>y</mi><mi>t</mi></msub><mo>=</mo><mi>C</mi><mo>&#x22C5;</mo><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t = \\bar{A} \\cdot h_{t-1} + \\bar{B} \\cdot x_t, \\quad y_t = C \\cdot h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9028em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>&#x9009;&#x62E9;&#x6027;&#x673A;&#x5236;&#xFF08;&#x53C2;&#x6570;&#x7531;&#x8F93;&#x5165;&#x51B3;&#x5B9A;&#xFF09;&#xFF1A;</strong>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>=</mo><mtext>Softplus</mtext><mo stretchy="false">(</mo><mtext>Linear</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi>B</mi><mo>=</mo><mtext>Linear</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"/><mi>C</mi><mo>=</mo><mtext>Linear</mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\Delta = \\text{Softplus}(\\text{Linear}(x_t)), \\quad B = \\text{Linear}(x_t), \\quad C = \\text{Linear}(x_t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Softplus</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Linear</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Linear</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Linear</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>&#x9009;&#x62E9;&#x6027;&#x7684;&#x6548;&#x679C;&#xFF1A;</strong></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\Delta \\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>A</mi><mo>&#x2C9;</mo></mover><mo>&#x2192;</mo><mi>I</mi><mo separator="true">,</mo><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover><mo>&#x2192;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\\bar{A} \\to I, \\bar{B} \\to 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">A</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1111em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> &#x2192; <strong>&#x4FDD;&#x6301;&#x8BB0;&#x5FC6;&#xFF0C;&#x5FFD;&#x7565;&#x8F93;&#x5165;</strong>&#xFF08;&#x8DF3;&#x8FC7;&#x5E9F;&#x8BDD;&#xFF09;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">&#x394;</mi><mo>&#x2192;</mo><mtext>large</mtext></mrow><annotation encoding="application/x-tex">\\Delta \\to \\text{large}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">&#x394;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2192;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">large</span></span></span></span></span>&#xFF1A;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>B</mi><mo>&#x2C9;</mo></mover></mrow><annotation encoding="application/x-tex">\\bar{B}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8201em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">&#x2C9;</span></span></span></span></span></span></span></span></span></span> &#x53D8;&#x5927; &#x2192; <strong>&#x5F3A;&#x529B;&#x5199;&#x5165;&#xFF0C;&#x66F4;&#x65B0;&#x8BB0;&#x5FC6;</strong>&#xFF08;&#x8BB0;&#x4F4F;&#x91CD;&#x70B9;&#xFF09;</li>
</ul>
<hr>
<h2 id="5. &#x7F51;&#x7EDC;&#x539F;&#x7406;&#x6DF1;&#x5EA6;&#x89E3;&#x6790;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;"><a href="#5. &#x7F51;&#x7EDC;&#x539F;&#x7406;&#x6DF1;&#x5EA6;&#x89E3;&#x6790;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;"></a>5. &#x7F51;&#x7EDC;&#x539F;&#x7406;&#x6DF1;&#x5EA6;&#x89E3;&#x6790;&#xFF1A;&#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;</h2>
<p>&#x8FD9;&#x4E00;&#x8282;&#x6211;&#x4EEC;&#x7528;&quot;&#x663E;&#x5FAE;&#x955C;&quot;&#x6765;&#x770B; Mamba &#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x7EC4;&#x4EF6;&#xFF1A;<strong>&#x5B83;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5B83;&#xFF1F;&#x5B83;&#x548C; Transformer &#x7684;&#x5BF9;&#x5E94;&#x7269;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;</strong></p>
<h3 id="5.1 &#x5B8C;&#x6574;&#x6570;&#x636E;&#x6D41;&#xFF1A;&#x4E00;&#x4E2A; Token &#x7684;&#x65C5;&#x7A0B;"><a href="#5.1 &#x5B8C;&#x6574;&#x6570;&#x636E;&#x6D41;&#xFF1A;&#x4E00;&#x4E2A; Token &#x7684;&#x65C5;&#x7A0B;"></a>5.1 &#x5B8C;&#x6574;&#x6570;&#x636E;&#x6D41;&#xFF1A;&#x4E00;&#x4E2A; Token &#x7684;&#x65C5;&#x7A0B;</h3>
<p>&#x5047;&#x8BBE;&#x8F93;&#x5165;&#x4E00;&#x53E5;&#x8BDD; <code>&quot;The cat sat on the mat&quot;</code>&#xFF0C;&#x6211;&#x4EEC;&#x8FFD;&#x8E2A;&#x7B2C; 3 &#x4E2A;&#x8BCD; <code>&quot;sat&quot;</code> &#x662F;&#x5982;&#x4F55;&#x88AB;&#x5904;&#x7406;&#x7684;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165;: &quot;sat&quot; (token_id = 1234)
       &#x2502;
       &#x25BC;
&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502; 1. Embedding Layer                                               &#x2502;
&#x2502;    token_id &#x2192; &#x5411;&#x91CF; x &#x2208; &#x211D;^D (&#x5982; D=768)                            &#x2502;
&#x2502;    &quot;sat&quot; &#x2192; [0.12, -0.34, 0.56, ..., 0.78]                        &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
       &#x2502;
       &#x25BC;
&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502; 2. Mamba Block (&#x91CD;&#x590D; N &#x6B21;, &#x5982; N=24)                              &#x2502;
&#x2502;                                                                  &#x2502;
&#x2502;  &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510; &#x2502;
&#x2502;  &#x2502; 2.1 &#x8F93;&#x5165;&#x6295;&#x5F71; (Linear)                                       &#x2502; &#x2502;
&#x2502;  &#x2502;     x &#x2208; &#x211D;^D &#x2192; [x_main, x_gate] &#x2208; &#x211D;^(2*E*D)                  &#x2502; &#x2502;
&#x2502;  &#x2502;     &#x7EF4;&#x5EA6;&#x653E;&#x5927; 2 &#x500D;&#xFF08;E=2&#xFF09;&#xFF0C;&#x5206;&#x6210;&#x4E24;&#x8DEF;                           &#x2502; &#x2502;
&#x2502;  &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518; &#x2502;
&#x2502;       &#x2502;                    &#x2502;                                     &#x2502;
&#x2502;       &#x25BC;                    &#x25BC;                                     &#x2502;
&#x2502;  &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;    &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;                           &#x2502;
&#x2502;  &#x2502; 2.2 &#x4E3B;&#x5206;&#x652F;   &#x2502;    &#x2502; 2.3 &#x95E8;&#x63A7;&#x5206;&#x652F; &#x2502;                           &#x2502;
&#x2502;  &#x2502;              &#x2502;    &#x2502;              &#x2502;                           &#x2502;
&#x2502;  &#x2502; Conv1d(k=4)  &#x2502;    &#x2502;   SiLU       &#x2502;                           &#x2502;
&#x2502;  &#x2502; &#x770B;&#x524D;3&#x4E2A;&#x8BCD;    &#x2502;    &#x2502;   &#x3C3;(x)&#xB7;x     &#x2502;                           &#x2502;
&#x2502;  &#x2502;      &#x2193;       &#x2502;    &#x2502;              &#x2502;                           &#x2502;
&#x2502;  &#x2502;   SiLU       &#x2502;    &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;                           &#x2502;
&#x2502;  &#x2502;      &#x2193;       &#x2502;           &#x2502;                                   &#x2502;
&#x2502;  &#x2502; &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510; &#x2502;           &#x2502;                                   &#x2502;
&#x2502;  &#x2502; &#x2502; SSM &#x6838;&#x5FC3; &#x2502; &#x2502;           &#x2502;                                   &#x2502;
&#x2502;  &#x2502; &#x2502; (&#x89C1;&#x4E0B;&#x6587;) &#x2502; &#x2502;           &#x2502;                                   &#x2502;
&#x2502;  &#x2502; &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518; &#x2502;           &#x2502;                                   &#x2502;
&#x2502;  &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;           &#x2502;                                   &#x2502;
&#x2502;       &#x2502;                     &#x2502;                                   &#x2502;
&#x2502;       &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500; &#xD7; &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;  (&#x9010;&#x5143;&#x7D20;&#x4E58;&#x6CD5;)                     &#x2502;
&#x2502;                  &#x2502;                                               &#x2502;
&#x2502;  &#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510; &#x2502;
&#x2502;  &#x2502; 2.4 &#x8F93;&#x51FA;&#x6295;&#x5F71; (Linear)                                       &#x2502; &#x2502;
&#x2502;  &#x2502;     &#x7EF4;&#x5EA6;&#x538B;&#x7F29;&#x56DE; D                                             &#x2502; &#x2502;
&#x2502;  &#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518; &#x2502;
&#x2502;                  &#x2502;                                               &#x2502;
&#x2502;                  + (&#x6B8B;&#x5DEE;&#x8FDE;&#x63A5;)                                    &#x2502;
&#x2502;                  &#x2502;                                               &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
       &#x2502;
       &#x25BC;
&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502; 3. Output Layer (LM Head)                                        &#x2502;
&#x2502;    &#x5411;&#x91CF; &#x2192; &#x8BCD;&#x8868;&#x6982;&#x7387;&#x5206;&#x5E03;                                           &#x2502;
&#x2502;    &#x9884;&#x6D4B;&#x4E0B;&#x4E00;&#x4E2A;&#x8BCD;                                                  &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
</code></pre>
<hr>
<h3 id="5.2 &#x6BCF;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x4F5C;&#x7528;&#xFF1A;&#x9010;&#x4E2A;&#x51FB;&#x7834;"><a href="#5.2 &#x6BCF;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x4F5C;&#x7528;&#xFF1A;&#x9010;&#x4E2A;&#x51FB;&#x7834;"></a>5.2 &#x6BCF;&#x4E2A;&#x7EC4;&#x4EF6;&#x7684;&#x4F5C;&#x7528;&#xFF1A;&#x9010;&#x4E2A;&#x51FB;&#x7834;</h3>
<h4 id="&#x7EC4;&#x4EF6; 1: Conv1d(kernel=4) &#x2014;&#x2014; &quot;&#x5C40;&#x90E8;&#x611F;&#x77E5;&#x5668;&quot;"><a href="#&#x7EC4;&#x4EF6; 1: Conv1d(kernel=4) &#x2014;&#x2014; &quot;&#x5C40;&#x90E8;&#x611F;&#x77E5;&#x5668;&quot;"></a>&#x7EC4;&#x4EF6; 1: Conv1d(kernel=4) &#x2014;&#x2014; &quot;&#x5C40;&#x90E8;&#x611F;&#x77E5;&#x5668;&quot;</h4>
<p><strong>&#x5B83;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</strong></p>
<pre><code class="language-python"><span class="hljs-comment"># &#x770B;&#x5F53;&#x524D;&#x8BCD;&#x548C;&#x524D;&#x9762; 3 &#x4E2A;&#x8BCD;</span>
y[t] = w[<span class="hljs-number">0</span>]*x[t-<span class="hljs-number">3</span>] + w[<span class="hljs-number">1</span>]*x[t-<span class="hljs-number">2</span>] + w[<span class="hljs-number">2</span>]*x[t-<span class="hljs-number">1</span>] + w[<span class="hljs-number">3</span>]*x[t]
</code></pre>
<p><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5B83;&#xFF1F;</strong></p>
<ul>
<li>SSM &#x64C5;&#x957F;<strong>&#x957F;&#x7A0B;&#x4F9D;&#x8D56;</strong>&#xFF08;&#x8BB0;&#x4F4F;&#x5F88;&#x4E45;&#x4EE5;&#x524D;&#x7684;&#x4FE1;&#x606F;&#xFF09;&#xFF0C;&#x4F46;&#x5BF9;<strong>&#x6781;&#x5C40;&#x90E8;&#x7684;&#x6A21;&#x5F0F;</strong>&#xFF08;&#x5982; N-gram&#xFF09;&#x4E0D;&#x654F;&#x611F;&#x3002;</li>
<li>Conv1d &#x5F25;&#x8865;&#x4E86;&#x8FD9;&#x4E2A;&#x77ED;&#x677F;&#xFF0C;&#x8BA9;&#x6A21;&#x578B;&#x80FD;&#x6355;&#x6349;&#x5230; <code>&quot;sat on&quot;</code> &#x8FD9;&#x79CD;&#x77ED;&#x8BED;&#x642D;&#x914D;&#x3002;</li>
</ul>
<p><strong>Transformer &#x7684;&#x5BF9;&#x5E94;&#x7269;&#xFF1F;</strong></p>
<ul>
<li>Transformer &#x6CA1;&#x6709;&#x4E13;&#x95E8;&#x7684;&#x5C40;&#x90E8;&#x611F;&#x77E5;&#xFF0C;&#x5B83;&#x9760; Attention &#x81EA;&#x5DF1;&#x5B66;&#x3002;</li>
<li>&#x4F46;&#x6709;&#x4E9B;&#x53D8;&#x4F53;&#xFF08;&#x5982; Conformer&#xFF09;&#x4E5F;&#x4F1A;&#x52A0; Conv1d&#x3002;</li>
</ul>
<hr>
<h4 id="&#x7EC4;&#x4EF6; 2: SiLU &#x6FC0;&#x6D3B; &#x2014;&#x2014; &quot;&#x975E;&#x7EBF;&#x6027;&#x53D8;&#x6362;&quot;"><a href="#&#x7EC4;&#x4EF6; 2: SiLU &#x6FC0;&#x6D3B; &#x2014;&#x2014; &quot;&#x975E;&#x7EBF;&#x6027;&#x53D8;&#x6362;&quot;"></a>&#x7EC4;&#x4EF6; 2: SiLU &#x6FC0;&#x6D3B; &#x2014;&#x2014; &quot;&#x975E;&#x7EBF;&#x6027;&#x53D8;&#x6362;&quot;</h4>
<p><strong>&#x5B83;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</strong>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>SiLU</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>&#x22C5;</mo><mi>&#x3C3;</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mo>&#x22C5;</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>&#x2212;</mo><mi>x</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\text{SiLU}(x) = x \\cdot \\sigma(x) = x \\cdot \\frac{1}{1 + e^{-x}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">SiLU</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">&#x3C3;</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.0908em;vertical-align:-0.7693em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6973em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">&#x2212;</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5B83;&#xFF1F;</strong></p>
<ul>
<li>&#x6CA1;&#x6709;&#x975E;&#x7EBF;&#x6027;&#xFF0C;&#x591A;&#x5C42;&#x7F51;&#x7EDC;&#x7B49;&#x4E8E;&#x5355;&#x5C42;&#xFF08;&#x77E9;&#x9635;&#x4E58;&#x6CD5;&#x7684;&#x94FE; = &#x4E00;&#x4E2A;&#x5927;&#x77E9;&#x9635;&#xFF09;&#x3002;</li>
<li>SiLU&#xFF08;&#x4E5F;&#x53EB; Swish&#xFF09;&#x6BD4; ReLU &#x66F4;&#x5E73;&#x6ED1;&#xFF0C;&#x68AF;&#x5EA6;&#x6D41;&#x52A8;&#x66F4;&#x7A33;&#x5B9A;&#x3002;</li>
</ul>
<p><strong>Transformer &#x7684;&#x5BF9;&#x5E94;&#x7269;&#xFF1F;</strong></p>
<ul>
<li>MLP &#x91CC;&#x7684; GELU &#x6216; ReLU&#x3002;</li>
</ul>
<hr>
<h4 id="&#x7EC4;&#x4EF6; 3: SSM &#x6838;&#x5FC3; &#x2014;&#x2014; &quot;&#x9009;&#x62E9;&#x6027;&#x8BB0;&#x5FC6;&#x5668;&quot;&#xFF08;&#x6700;&#x5173;&#x952E;&#xFF01;&#xFF09;"><a href="#&#x7EC4;&#x4EF6; 3: SSM &#x6838;&#x5FC3; &#x2014;&#x2014; &quot;&#x9009;&#x62E9;&#x6027;&#x8BB0;&#x5FC6;&#x5668;&quot;&#xFF08;&#x6700;&#x5173;&#x952E;&#xFF01;&#xFF09;"></a>&#x7EC4;&#x4EF6; 3: SSM &#x6838;&#x5FC3; &#x2014;&#x2014; &quot;&#x9009;&#x62E9;&#x6027;&#x8BB0;&#x5FC6;&#x5668;&quot;&#xFF08;&#x6700;&#x5173;&#x952E;&#xFF01;&#xFF09;</h4>
<p>&#x8FD9;&#x662F; Mamba &#x66FF;&#x4EE3; Attention &#x7684;&#x6838;&#x5FC3;&#x3002;&#x8BA9;&#x6211;&#x4EEC;&#x653E;&#x5927;&#x6765;&#x770B;&#xFF1A;</p>
<pre><code>&#x8F93;&#x5165; x_t (&#x5F53;&#x524D;&#x8BCD;&#x7684;&#x7279;&#x5F81;&#x5411;&#x91CF;)
    &#x2502;
    &#x251C;&#x2500;&#x2500;&#x2192; Linear_&#x394; &#x2192; Softplus &#x2192; &#x394;_t (&#x6B65;&#x957F;/&#x9057;&#x5FD8;&#x7387;)
    &#x2502;
    &#x251C;&#x2500;&#x2500;&#x2192; Linear_B &#x2192; B_t (&#x8F93;&#x5165;&#x6743;&#x91CD;)
    &#x2502;
    &#x251C;&#x2500;&#x2500;&#x2192; Linear_C &#x2192; C_t (&#x8F93;&#x51FA;&#x6743;&#x91CD;)
    &#x2502;
    &#x25BC;
&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502;               &#x72B6;&#x6001;&#x66F4;&#x65B0; (SSM Recurrence)             &#x2502;
&#x2502;                                                     &#x2502;
&#x2502;  h_t = exp(-&#x394;_t * A) &#xB7; h_{t-1} + &#x394;_t * B_t &#xB7; x_t   &#x2502;
&#x2502;        &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;   &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;  &#x2502;
&#x2502;        &quot;&#x8870;&#x51CF;&#x65E7;&#x8BB0;&#x5FC6;&quot;               &quot;&#x5199;&#x5165;&#x65B0;&#x4FE1;&#x606F;&quot;      &#x2502;
&#x2502;                                                     &#x2502;
&#x2502;  y_t = C_t &#xB7; h_t                                    &#x2502;
&#x2502;        &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;                                   &#x2502;
&#x2502;        &quot;&#x4ECE;&#x8BB0;&#x5FC6;&#x4E2D;&#x8BFB;&#x53D6;&quot;                               &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
    &#x2502;
    &#x25BC;
&#x8F93;&#x51FA; y_t (&#x878D;&#x5408;&#x4E86;&#x5386;&#x53F2;&#x4FE1;&#x606F;&#x7684;&#x7279;&#x5F81;&#x5411;&#x91CF;)
</code></pre>
<p><strong>&#x6BCF;&#x4E2A;&#x53C2;&#x6570;&#x7684;&#x76F4;&#x89C9;&#x7406;&#x89E3;&#xFF1A;</strong></p>
<table>
<thead>
<tr>
<th>&#x53C2;&#x6570;</th>
<th>&#x7C7B;&#x6BD4;</th>
<th>&#x4F5C;&#x7528;</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">&#x394;</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\\Delta_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord">&#x394;</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td>&#x9600;&#x95E8;&#x5F00;&#x5173;</td>
<td>&#x63A7;&#x5236;&quot;&#x8BB0;&#x5FC6;&#x66F4;&#x65B0;&#x901F;&#x5EA6;&quot;&#x3002;&#x5927; &#x2192; &#x5FEB;&#x901F;&#x8986;&#x76D6;&#x65E7;&#x8BB0;&#x5FC6;&#xFF1B;&#x5C0F; &#x2192; &#x4FDD;&#x6301;&#x65E7;&#x8BB0;&#x5FC6;</td>
</tr>
<tr>
<td><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></strong></td>
<td>&#x8BB0;&#x5FC6;&#x8870;&#x51CF;&#x7387;</td>
<td>&#x56FA;&#x5B9A;&#x53C2;&#x6570;&#xFF0C;&#x51B3;&#x5B9A;&#x8BB0;&#x5FC6;&#x7684;&quot;&#x534A;&#x8870;&#x671F;&quot;&#xFF08;&#x591A;&#x4E45;&#x5FD8;&#x6389;&#x4E00;&#x534A;&#xFF09;</td>
</tr>
<tr>
<td><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">B_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td>&#x5199;&#x5165;&#x6743;&#x91CD;</td>
<td>&#x51B3;&#x5B9A;&quot;&#x5F53;&#x524D;&#x8BCD;&#x7684;&#x54EA;&#x4E9B;&#x7279;&#x5F81;&quot;&#x88AB;&#x5199;&#x5165;&#x8BB0;&#x5FC6;</td>
</tr>
<tr>
<td><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">C_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td>&#x8BFB;&#x53D6;&#x6743;&#x91CD;</td>
<td>&#x51B3;&#x5B9A;&quot;&#x4ECE;&#x8BB0;&#x5FC6;&#x4E2D;&#x63D0;&#x53D6;&#x54EA;&#x4E9B;&#x7279;&#x5F81;&quot;&#x4F5C;&#x4E3A;&#x8F93;&#x51FA;</td>
</tr>
<tr>
<td><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></strong></td>
<td>&#x8BB0;&#x5FC6;&#x72B6;&#x6001;</td>
<td>&#x4E00;&#x4E2A;&#x5411;&#x91CF;&#xFF0C;&#x538B;&#x7F29;&#x4E86;&#x6240;&#x6709;&#x5386;&#x53F2;&#x4FE1;&#x606F;</td>
</tr>
</tbody>
</table>
<p><strong>Transformer &#x7684;&#x5BF9;&#x5E94;&#x7269;&#xFF1F;</strong></p>
<table>
<thead>
<tr>
<th>Mamba</th>
<th>Transformer</th>
<th>&#x5BF9;&#x6BD4;</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF08;&#x72B6;&#x6001;&#x5411;&#x91CF;&#xFF09;</td>
<td>KV Cache&#xFF08;&#x6240;&#x6709;&#x5386;&#x53F2;&#x7684; K&#x3001;V&#xFF09;</td>
<td>Mamba: &#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#xFF1B;Transformer: &#x968F;&#x5E8F;&#x5217;&#x589E;&#x957F;</td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>t</mi></msub><mo>&#x22C5;</mo><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">B_t \\cdot x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF08;&#x5199;&#x5165;&#xFF09;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>V</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">K_t, V_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF08;&#x5B58;&#x5165;&#x7F13;&#x5B58;&#xFF09;</td>
<td>&#x7C7B;&#x4F3C;&#xFF0C;&#x90FD;&#x662F;&#x628A;&#x5F53;&#x524D;&#x4FE1;&#x606F;&#x5B58;&#x8D77;&#x6765;</td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>t</mi></msub><mo>&#x22C5;</mo><msub><mi>h</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">C_t \\cdot h_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>&#xFF08;&#x8BFB;&#x53D6;&#xFF09;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Softmax</mtext><mo stretchy="false">(</mo><msub><mi>Q</mi><mi>t</mi></msub><msup><mi>K</mi><mi>T</mi></msup><mo stretchy="false">)</mo><mi>V</mi></mrow><annotation encoding="application/x-tex">\\text{Softmax}(Q_t K^T) V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0913em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Softmax</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>&#xFF08;&#x67E5;&#x8BE2;&#xFF09;</td>
<td>&#x5173;&#x952E;&#x533A;&#x522B;&#xFF1A;Mamba &#x4E0D;&#x80FD;&#x7CBE;&#x786E;&#x56DE;&#x6EAF;&#xFF01;</td>
</tr>
</tbody>
</table>
<hr>
<h4 id="&#x7EC4;&#x4EF6; 4: &#x95E8;&#x63A7;&#x4E58;&#x6CD5; &#x2014;&#x2014; &quot;&#x4FE1;&#x606F;&#x8FC7;&#x6EE4;&#x5668;&quot;"><a href="#&#x7EC4;&#x4EF6; 4: &#x95E8;&#x63A7;&#x4E58;&#x6CD5; &#x2014;&#x2014; &quot;&#x4FE1;&#x606F;&#x8FC7;&#x6EE4;&#x5668;&quot;"></a>&#x7EC4;&#x4EF6; 4: &#x95E8;&#x63A7;&#x4E58;&#x6CD5; &#x2014;&#x2014; &quot;&#x4FE1;&#x606F;&#x8FC7;&#x6EE4;&#x5668;&quot;</h4>
<p><strong>&#x5B83;&#x5728;&#x505A;&#x4EC0;&#x4E48;&#xFF1F;</strong></p>
<pre><code class="language-python">output = main_branch * gate_branch
</code></pre>
<p><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x5B83;&#xFF1F;</strong></p>
<ul>
<li>&#x95E8;&#x63A7;&#x5206;&#x652F;&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&quot;&#x63A9;&#x7801;&quot;&#xFF0C;&#x544A;&#x8BC9;&#x6A21;&#x578B;&quot;&#x4E3B;&#x5206;&#x652F;&#x7684;&#x54EA;&#x4E9B;&#x7279;&#x5F81;&#x662F;&#x6709;&#x7528;&#x7684;&quot;&#x3002;</li>
<li>&#x8FD9;&#x548C; LSTM &#x7684;&#x95E8;&#x63A7;&#x673A;&#x5236;&#x3001;Transformer &#x7684; SwiGLU &#x601D;&#x60F3;&#x4E00;&#x8109;&#x76F8;&#x627F;&#x3002;</li>
</ul>
<p><strong>Transformer &#x7684;&#x5BF9;&#x5E94;&#x7269;&#xFF1F;</strong></p>
<ul>
<li>MLP &#x4E2D;&#x7684; SwiGLU&#xFF1A;<code>output = (xW_1) * SiLU(xW_gate) * W_2</code></li>
</ul>
<hr>
<h3 id="5.3 &#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x548C; Transformer &#x76F8;&#x63D0;&#x5E76;&#x8BBA;&#xFF1F;"><a href="#5.3 &#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x548C; Transformer &#x76F8;&#x63D0;&#x5E76;&#x8BBA;&#xFF1F;"></a>5.3 &#x4E3A;&#x4EC0;&#x4E48; Mamba &#x80FD;&#x548C; Transformer &#x76F8;&#x63D0;&#x5E76;&#x8BBA;&#xFF1F;</h3>
<h4 id="&#x6838;&#x5FC3;&#x5BF9;&#x6BD4;&#xFF1A;&#x4FE1;&#x606F;&#x6D41;&#x7684;&#x672C;&#x8D28;&#x5DEE;&#x5F02;"><a href="#&#x6838;&#x5FC3;&#x5BF9;&#x6BD4;&#xFF1A;&#x4FE1;&#x606F;&#x6D41;&#x7684;&#x672C;&#x8D28;&#x5DEE;&#x5F02;"></a>&#x6838;&#x5FC3;&#x5BF9;&#x6BD4;&#xFF1A;&#x4FE1;&#x606F;&#x6D41;&#x7684;&#x672C;&#x8D28;&#x5DEE;&#x5F02;</h4>
<pre><code>Transformer&#xFF08;&#x5168;&#x5C40;&#x89C6;&#x91CE;&#xFF0C;&#x4F46;&#x6602;&#x8D35;&#xFF09;:
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;
  t=1    t=2    t=3    t=4    t=5
   &#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;
   &#x2502;&#x2572;    &#x2571;&#x2502;&#x2572;    &#x2571;&#x2502;&#x2572;    &#x2571;&#x2502;&#x2572;    &#x2571;&#x2502;
   &#x2502; &#x2572;  &#x2571; &#x2502; &#x2572;  &#x2571; &#x2502; &#x2572;  &#x2571; &#x2502; &#x2572;  &#x2571; &#x2502;
   &#x2502;  &#x2573;  &#x2502;  &#x2573;  &#x2502;  &#x2573;  &#x2502;  &#x2573;  &#x2502;
   &#x2502; &#x2571;  &#x2572; &#x2502; &#x2571;  &#x2572; &#x2502; &#x2571;  &#x2572; &#x2502; &#x2571;  &#x2572; &#x2502;
   &#x2502;&#x2571;    &#x2572;&#x2502;&#x2571;    &#x2572;&#x2502;&#x2571;    &#x2572;&#x2502;&#x2571;    &#x2572;&#x2502;
   &#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x25CF;
   
   &#x6BCF;&#x4E2A;&#x4F4D;&#x7F6E;&#x90FD;&#x80FD;&#x76F4;&#x63A5;&#x770B;&#x5230;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x4F4D;&#x7F6E;
   &#x4EE3;&#x4EF7;: O(N&#xB2;) &#x8BA1;&#x7B97;&#xFF0C;O(N) &#x663E;&#x5B58;


Mamba&#xFF08;&#x538B;&#x7F29;&#x89C6;&#x91CE;&#xFF0C;&#x4F46;&#x9AD8;&#x6548;&#xFF09;:
&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;
  t=1    t=2    t=3    t=4    t=5
   &#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2192;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2192;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2192;&#x25CF;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2192;&#x25CF;
   &#x2502;      &#x2502;      &#x2502;      &#x2502;      &#x2502;
   &#x25BC;      &#x25BC;      &#x25BC;      &#x25BC;      &#x25BC;
  [h&#x2081;]&#x2500;&#x2500;&#x2192;[h&#x2082;]&#x2500;&#x2500;&#x2192;[h&#x2083;]&#x2500;&#x2500;&#x2192;[h&#x2084;]&#x2500;&#x2500;&#x2192;[h&#x2085;]
  
   &#x4FE1;&#x606F;&#x901A;&#x8FC7;&quot;&#x72B6;&#x6001;&#x5411;&#x91CF; h&quot;&#x9010;&#x6B65;&#x4F20;&#x9012;
   &#x4EE3;&#x4EF7;: O(N) &#x8BA1;&#x7B97;&#xFF0C;O(1) &#x663E;&#x5B58;
</code></pre>
<h4 id="&#x4E09;&#x4E2A;&#x5C42;&#x9762;&#x7684;&#x5BF9;&#x6BD4;"><a href="#&#x4E09;&#x4E2A;&#x5C42;&#x9762;&#x7684;&#x5BF9;&#x6BD4;"></a>&#x4E09;&#x4E2A;&#x5C42;&#x9762;&#x7684;&#x5BF9;&#x6BD4;</h4>
<p><strong>1. &#x4FE1;&#x606F;&#x83B7;&#x53D6;&#x65B9;&#x5F0F;</strong></p>
<table>
<thead>
<tr>
<th>&#x7EF4;&#x5EA6;</th>
<th>Transformer</th>
<th>Mamba</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>&#x8BBF;&#x95EE;&#x5386;&#x53F2;</strong></td>
<td>&#x7CBE;&#x786E;&#x56DE;&#x6EAF;&#xFF08;KV Cache &#x5B58;&#x7740;&#x4E00;&#x5207;&#xFF09;</td>
<td>&#x6A21;&#x7CCA;&#x56DE;&#x5FC6;&#xFF08;&#x538B;&#x7F29;&#x5728;&#x72B6;&#x6001;&#x91CC;&#xFF09;</td>
</tr>
<tr>
<td><strong>&#x7C7B;&#x6BD4;</strong></td>
<td>&#x5F00;&#x5377;&#x8003;&#x8BD5;&#xFF0C;&#x53EF;&#x4EE5;&#x7FFB;&#x4E66;</td>
<td>&#x95ED;&#x5377;&#x8003;&#x8BD5;&#xFF0C;&#x53EA;&#x80FD;&#x51ED;&#x8BB0;&#x5FC6;</td>
</tr>
<tr>
<td><strong>&#x64C5;&#x957F;</strong></td>
<td>&#x7CBE;&#x786E;&#x5339;&#x914D;&#xFF08;&quot;&#x7B2C;3&#x6BB5;&#x7B2C;2&#x53E5;&#x8BF4;&#x4E86;&#x5565;&quot;&#xFF09;</td>
<td>&#x6A21;&#x5F0F;&#x63D0;&#x53D6;&#xFF08;&quot;&#x6574;&#x4F53;&#x5728;&#x8BB2;&#x4EC0;&#x4E48;&quot;&#xFF09;</td>
</tr>
</tbody>
</table>
<p><strong>2. &#x8BA1;&#x7B97;&#x6548;&#x7387;</strong></p>
<table>
<thead>
<tr>
<th>&#x7EF4;&#x5EA6;</th>
<th>Transformer</th>
<th>Mamba</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>&#x8BAD;&#x7EC3;</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N^2)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF08;Attention &#x77E9;&#x9635;&#xFF09;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x5E76;&#x884C;&#x626B;&#x63CF;&#xFF09;</td>
</tr>
<tr>
<td><strong>&#x63A8;&#x7406;&#xFF08;&#x6BCF;&#x6B65;&#xFF09;</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x67E5;&#x8BE2;&#x6240;&#x6709;&#x5386;&#x53F2; KV&#xFF09;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x53EA;&#x66F4;&#x65B0;&#x72B6;&#x6001; h&#xFF09;</td>
</tr>
<tr>
<td><strong>&#x663E;&#x5B58;&#xFF08;&#x63A8;&#x7406;&#xFF09;</strong></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x5B58;&#x6240;&#x6709; KV&#xFF09;</td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x53EA;&#x5B58;&#x72B6;&#x6001; h&#xFF09;</td>
</tr>
</tbody>
</table>
<p><strong>3. &#x80FD;&#x529B;&#x8FB9;&#x754C;</strong></p>
<table>
<thead>
<tr>
<th>&#x4EFB;&#x52A1;</th>
<th>Transformer</th>
<th>Mamba</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>&#x7CBE;&#x786E;&#x590D;&#x5236;</strong>&#xFF08;&quot;&#x91CD;&#x590D;&#x7B2C;5&#x4E2A;&#x8BCD;&quot;&#xFF09;</td>
<td>&#x5B8C;&#x7F8E;</td>
<td>&#x56F0;&#x96BE;&#xFF08;&#x4FE1;&#x606F;&#x88AB;&#x538B;&#x7F29;&#x4E86;&#xFF09;</td>
</tr>
<tr>
<td><strong>&#x6A21;&#x5F0F;&#x8BC6;&#x522B;</strong>&#xFF08;&quot;&#x8FD9;&#x6BB5;&#x8BDD;&#x7684;&#x60C5;&#x611F;&quot;&#xFF09;</td>
<td>&#x4F18;&#x79C0;</td>
<td>&#x4F18;&#x79C0;</td>
</tr>
<tr>
<td><strong>&#x8D85;&#x957F;&#x6587;&#x672C;</strong>&#xFF08;100k+ tokens&#xFF09;</td>
<td>OOM &#x6216;&#x6781;&#x6162;</td>
<td>&#x8F7B;&#x677E;&#x5904;&#x7406;</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="5.4 Mamba &#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;&#x2014;&#x2014; &#x6DF1;&#x5C42;&#x539F;&#x7406;"><a href="#5.4 Mamba &#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;&#x2014;&#x2014; &#x6DF1;&#x5C42;&#x539F;&#x7406;"></a>5.4 Mamba &#x4E3A;&#x4EC0;&#x4E48;&#x80FD;&#x5DE5;&#x4F5C;&#xFF1F;&#x2014;&#x2014; &#x6DF1;&#x5C42;&#x539F;&#x7406;</h3>
<h4 id="&#x539F;&#x7406; 1: &#x9009;&#x62E9;&#x6027; = &#x52A8;&#x6001;&#x538B;&#x7F29;&#x7387;"><a href="#&#x539F;&#x7406; 1: &#x9009;&#x62E9;&#x6027; = &#x52A8;&#x6001;&#x538B;&#x7F29;&#x7387;"></a>&#x539F;&#x7406; 1: &#x9009;&#x62E9;&#x6027; = &#x52A8;&#x6001;&#x538B;&#x7F29;&#x7387;</h4>
<p>&#x4F20;&#x7EDF;&#x538B;&#x7F29;&#xFF08;&#x5982; JPEG&#xFF09;&#x7528;&#x56FA;&#x5B9A;&#x89C4;&#x5219;&#x4E22;&#x5F03;&#x4FE1;&#x606F;&#x3002;Mamba &#x7684;&#x9009;&#x62E9;&#x6027;&#x8BA9;&#x6A21;&#x578B;<strong>&#x81EA;&#x5DF1;&#x5B66;&#x4F1A;</strong>&#x4EC0;&#x4E48;&#x8BE5;&#x4E22;&#x3001;&#x4EC0;&#x4E48;&#x8BE5;&#x7559;&#x3002;</p>
<pre><code>&#x8F93;&#x5165;: &quot;The quick brown fox jumps over the lazy dog&quot;

&#x4F20;&#x7EDF; SSM&#xFF08;&#x56FA;&#x5B9A;&#x538B;&#x7F29;&#xFF09;:
  &#x6BCF;&#x4E2A;&#x8BCD;&#x90FD;&#x540C;&#x7B49;&#x5BF9;&#x5F85;&#xFF0C;&#x91CD;&#x8981;&#x4FE1;&#x606F;&#x548C;&#x5E9F;&#x8BDD;&#x6DF7;&#x5728;&#x4E00;&#x8D77;
  &#x2192; &#x72B6;&#x6001;&#x91CC;&#x5145;&#x6EE1;&#x566A;&#x97F3;

Mamba&#xFF08;&#x9009;&#x62E9;&#x6027;&#x538B;&#x7F29;&#xFF09;:
  &quot;The&quot; &#x2192; &#x394; &#x5C0F;&#xFF0C;&#x51E0;&#x4E4E;&#x4E0D;&#x66F4;&#x65B0;&#xFF08;&#x51A0;&#x8BCD;&#x4E0D;&#x91CD;&#x8981;&#xFF09;
  &quot;fox&quot; &#x2192; &#x394; &#x5927;&#xFF0C;&#x5F3A;&#x529B;&#x5199;&#x5165;&#xFF08;&#x4E3B;&#x8BED;&#x5F88;&#x91CD;&#x8981;&#xFF09;
  &quot;jumps&quot; &#x2192; &#x394; &#x5927;&#xFF0C;&#x5F3A;&#x529B;&#x5199;&#x5165;&#xFF08;&#x52A8;&#x4F5C;&#x5F88;&#x91CD;&#x8981;&#xFF09;
  &quot;the&quot; &#x2192; &#x394; &#x5C0F;&#xFF0C;&#x5FFD;&#x7565;
  &#x2192; &#x72B6;&#x6001;&#x91CC;&#x53EA;&#x4FDD;&#x7559;&#x5173;&#x952E;&#x4FE1;&#x606F;
</code></pre>
<h4 id="&#x539F;&#x7406; 2: &#x72B6;&#x6001;&#x7EF4;&#x5EA6; = &#x8BB0;&#x5FC6;&#x5BB9;&#x91CF;"><a href="#&#x539F;&#x7406; 2: &#x72B6;&#x6001;&#x7EF4;&#x5EA6; = &#x8BB0;&#x5FC6;&#x5BB9;&#x91CF;"></a>&#x539F;&#x7406; 2: &#x72B6;&#x6001;&#x7EF4;&#x5EA6; = &#x8BB0;&#x5FC6;&#x5BB9;&#x91CF;</h4>
<p>Mamba &#x7684;&#x72B6;&#x6001; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>&#x2208;</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>D</mi><mo>&#xD7;</mo><mi>N</mi></mrow></msup></mrow><annotation encoding="application/x-tex">h \\in \\mathbb{R}^{D \\times N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2208;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8413em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">D</span><span class="mbin mtight">&#xD7;</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span></span></span></span></span></span></span></span>&#xFF0C;&#x5176;&#x4E2D; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x662F;&quot;&#x72B6;&#x6001;&#x6269;&#x5C55;&#x56E0;&#x5B50;&quot;&#xFF08;&#x901A;&#x5E38; 16-64&#xFF09;&#x3002;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x8D8A;&#x5927; &#x2192; &#x8BB0;&#x5FC6;&#x5BB9;&#x91CF;&#x8D8A;&#x5927; &#x2192; &#x80FD;&#x8BB0;&#x4F4F;&#x66F4;&#x591A;&#x7EC6;&#x8282;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x8D8A;&#x5927; &#x2192; &#x8BA1;&#x7B97;&#x91CF;&#x8D8A;&#x5927; &#x2192; &#x4F46;&#x4ECD;&#x662F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><msub><mi>N</mi><mrow><mi>s</mi><mi>e</mi><mi>q</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N_{seq})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">se</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> &#x7EBF;&#x6027;</li>
</ul>
<p>&#x8FD9;&#x5C31;&#x50CF;&#xFF1A;</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>16</mn></mrow><annotation encoding="application/x-tex">N=16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">16</span></span></span></span>&#xFF1A;&#x7528; 16 &#x4E2A;&quot;&#x8BB0;&#x5FC6;&#x69FD;&quot;&#x538B;&#x7F29;&#x6574;&#x7BC7;&#x6587;&#x7AE0;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>64</mn></mrow><annotation encoding="application/x-tex">N=64</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">64</span></span></span></span>&#xFF1A;&#x7528; 64 &#x4E2A;&quot;&#x8BB0;&#x5FC6;&#x69FD;&quot;&#xFF0C;&#x80FD;&#x8BB0;&#x4F4F;&#x66F4;&#x591A;&#x7EC6;&#x8282;</li>
</ul>
<h4 id="&#x539F;&#x7406; 3: &#x591A;&#x5C42;&#x5806;&#x53E0; = &#x6E10;&#x8FDB;&#x5F0F;&#x62BD;&#x8C61;"><a href="#&#x539F;&#x7406; 3: &#x591A;&#x5C42;&#x5806;&#x53E0; = &#x6E10;&#x8FDB;&#x5F0F;&#x62BD;&#x8C61;"></a>&#x539F;&#x7406; 3: &#x591A;&#x5C42;&#x5806;&#x53E0; = &#x6E10;&#x8FDB;&#x5F0F;&#x62BD;&#x8C61;</h4>
<p>&#x5355;&#x5C42; Mamba &#x53EA;&#x80FD;&#x505A;&#x7B80;&#x5355;&#x7684;&#x5E8F;&#x5217;&#x6DF7;&#x5408;&#x3002;&#x4F46;&#x5F53;&#x6211;&#x4EEC;&#x5806;&#x53E0; 24-48 &#x5C42;&#x65F6;&#xFF1A;</p>
<pre><code>Layer 1:  &#x8BCD;&#x7EA7;&#x522B;&#x7279;&#x5F81;&#xFF08;&quot;sat&quot; &#x662F;&#x52A8;&#x8BCD;&#xFF09;
Layer 6:  &#x77ED;&#x8BED;&#x7EA7;&#x522B;&#xFF08;&quot;sat on&quot; &#x662F;&#x4F4D;&#x7F6E;&#x4ECB;&#x8BCD;&#x77ED;&#x8BED;&#xFF09;
Layer 12: &#x53E5;&#x5B50;&#x7EA7;&#x522B;&#xFF08;&quot;&#x4E3B;&#x8BED;&#x5728;&#x67D0;&#x5904;&quot;&#xFF09;
Layer 24: &#x8BED;&#x4E49;&#x7EA7;&#x522B;&#xFF08;&quot;&#x63CF;&#x8FF0;&#x4E00;&#x4E2A;&#x573A;&#x666F;&quot;&#xFF09;
</code></pre>
<p>&#x6BCF;&#x4E00;&#x5C42;&#x7684; SSM &#x90FD;&#x5728;<strong>&#x66F4;&#x9AD8;&#x7684;&#x62BD;&#x8C61;&#x5C42;&#x6B21;</strong>&#x4E0A;&#x505A;&quot;&#x9009;&#x62E9;&#x6027;&#x8BB0;&#x5FC6;&quot;&#x3002;</p>
<hr>
<h3 id="5.5 &#x4E00;&#x5F20;&#x56FE;&#x603B;&#x7ED3;&#xFF1A;Mamba vs Transformer"><a href="#5.5 &#x4E00;&#x5F20;&#x56FE;&#x603B;&#x7ED3;&#xFF1A;Mamba vs Transformer"></a>5.5 &#x4E00;&#x5F20;&#x56FE;&#x603B;&#x7ED3;&#xFF1A;Mamba vs Transformer</h3>
<pre><code>&#x250C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2510;
&#x2502;                    &#x5E8F;&#x5217;&#x5EFA;&#x6A21;&#x7684;&#x4E09;&#x5927;&#x6D41;&#x6D3E;                           &#x2502;
&#x251C;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2524;
&#x2502;                                                                 &#x2502;
&#x2502;  Transformer              RNN                 Mamba             &#x2502;
&#x2502;  &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;              &#x2500;&#x2500;&#x2500;                 &#x2500;&#x2500;&#x2500;&#x2500;&#x2500;             &#x2502;
&#x2502;                                                                 &#x2502;
&#x2502;  &#x4FE1;&#x606F;&#x5B58;&#x50A8;:               &#x4FE1;&#x606F;&#x5B58;&#x50A8;:            &#x4FE1;&#x606F;&#x5B58;&#x50A8;:         &#x2502;
&#x2502;  [KV Cache]              [State h]            [State h]         &#x2502;
&#x2502;  &#x6240;&#x6709;&#x5386;&#x53F2;                 &#x56FA;&#x5B9A;&#x5927;&#x5C0F;             &#x56FA;&#x5B9A;&#x5927;&#x5C0F;          &#x2502;
&#x2502;  O(N) &#x663E;&#x5B58;               O(1) &#x663E;&#x5B58;            O(1) &#x663E;&#x5B58;         &#x2502;
&#x2502;                                                                 &#x2502;
&#x2502;  &#x4FE1;&#x606F;&#x8BBF;&#x95EE;:               &#x4FE1;&#x606F;&#x8BBF;&#x95EE;:            &#x4FE1;&#x606F;&#x8BBF;&#x95EE;:         &#x2502;
&#x2502;  Attention               &#x56FA;&#x5B9A;&#x8870;&#x51CF;             &#x9009;&#x62E9;&#x6027;&#x8870;&#x51CF;        &#x2502;
&#x2502;  &#x7CBE;&#x786E;&#x56DE;&#x6EAF;                 &#x65E0;&#x9009;&#x62E9;               &#x5185;&#x5BB9;&#x611F;&#x77E5;          &#x2502;
&#x2502;  O(N&#xB2;) &#x8BA1;&#x7B97;              O(N) &#x8BA1;&#x7B97;            O(N) &#x8BA1;&#x7B97;         &#x2502;
&#x2502;                                                                 &#x2502;
&#x2502;  &#x8BAD;&#x7EC3;:                   &#x8BAD;&#x7EC3;:                &#x8BAD;&#x7EC3;:             &#x2502;
&#x2502;  &#x5E76;&#x884C; (&#x77E9;&#x9635;&#x4E58;)           &#x4E32;&#x884C; (&#x9012;&#x5F52;)          &#x5E76;&#x884C; (&#x626B;&#x63CF;)       &#x2502;
&#x2502;  &#x5FEB;                      &#x6162;                   &#x5FEB;                &#x2502;
&#x2502;                                                                 &#x2502;
&#x2502;  &#x957F;&#x5E8F;&#x5217;:                 &#x957F;&#x5E8F;&#x5217;:              &#x957F;&#x5E8F;&#x5217;:           &#x2502;
&#x2502;  OOM                     &#x9057;&#x5FD8;                 &#x8BB0;&#x4F4F;&#x91CD;&#x70B9;          &#x2502;
&#x2502;                                                                 &#x2502;
&#x2514;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2500;&#x2518;
</code></pre>
<p><strong>&#x7ED3;&#x8BBA;&#xFF1A;Mamba &#x53D6;&#x4E86; Transformer &#x548C; RNN &#x7684;&#x957F;&#x5904;</strong></p>
<ul>
<li>&#x4ECE; Transformer &#x5B66;&#xFF1A;&#x5E76;&#x884C;&#x8BAD;&#x7EC3;&#x3001;&#x9AD8;&#x6027;&#x80FD;</li>
<li>&#x4ECE; RNN &#x5B66;&#xFF1A;&#x56FA;&#x5B9A;&#x663E;&#x5B58;&#x3001;&#x5FEB;&#x901F;&#x63A8;&#x7406;</li>
<li>&#x72EC;&#x521B;&#xFF1A;&#x9009;&#x62E9;&#x6027;&#x673A;&#x5236;&#xFF0C;&#x8BA9;&#x538B;&#x7F29;&#x53D8;&#x5F97;&quot;&#x806A;&#x660E;&quot;</li>
</ul>
<hr>
<h2 id="6. RWKV &#x662F;&#x4EC0;&#x4E48;&#xFF1F;"><a href="#6. RWKV &#x662F;&#x4EC0;&#x4E48;&#xFF1F;"></a>6. RWKV &#x662F;&#x4EC0;&#x4E48;&#xFF1F;</h2>
<p><strong>RWKV</strong> (Receptance Weighted Key Value) &#x662F;&#x53E6;&#x4E00;&#x6761;&#x7EBF;&#x8DEF;&#x7684;&#x63A2;&#x7D22;&#xFF0C;&#x4F46;&#x4E5F;&#x5C5E;&#x4E8E;**&quot;&#x7EBF;&#x6027; Attention&quot;<strong>&#x6216;</strong>&quot;&#x73B0;&#x4EE3; RNN&quot;** &#x5BB6;&#x65CF;&#x3002;</p>
<ul>
<li>
<p><strong>&#x5B83;&#x7684;&#x672C;&#x8D28;&#xFF1A;</strong>
RWKV &#x8BD5;&#x56FE;&#x5C06; Transformer &#x7684; Attention &#x516C;&#x5F0F;&#x91CD;&#x5199;&#x6210; RNN &#x7684;&#x5F62;&#x5F0F;&#x3002;
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Attention</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo separator="true">,</mo><mi>K</mi><mo separator="true">,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>&#x2248;</mo><mfrac><mrow><mo>&#x2211;</mo><msup><mi>e</mi><mrow><mi>w</mi><mo>&#x22C5;</mo><mi>t</mi></mrow></msup><msub><mi>K</mi><mi>t</mi></msub><msub><mi>V</mi><mi>t</mi></msub></mrow><mrow><mo>&#x2211;</mo><msup><mi>e</mi><mrow><mi>w</mi><mo>&#x22C5;</mo><mi>t</mi></mrow></msup><msub><mi>K</mi><mi>t</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">\\text{Attention}(Q,K,V) \\approx \\frac{\\sum e^{w \\cdot t} K_t V_t}{\\sum e^{w \\cdot t} K_t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Attention</span></span><span class="mopen">(</span><span class="mord mathnormal">Q</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&#x2248;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4066em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4706em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">&#x2211;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7196em;"><span style="top:-2.989em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">&#x22C5;</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-symbol small-op" style="position:relative;top:0em;">&#x2211;</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">&#x22C5;</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span>
&#x8FD9;&#x91CC;&#x7684; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>e</mi><mrow><mi>w</mi><mo>&#x22C5;</mo><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">e^{w \\cdot t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7936em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span><span class="mbin mtight">&#x22C5;</span><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span> &#x7C7B;&#x4F3C;&#x4E8E; RNN &#x4E2D;&#x7684;&#x9057;&#x5FD8;&#x95E8;&#xFF08;Decay&#xFF09;&#x3002;</p>
</li>
<li>
<p><strong>&#x4E3A;&#x4EC0;&#x4E48;&#x5FEB;&#xFF1F;</strong>
&#x548C; Mamba &#x4E00;&#x6837;&#xFF0C;RWKV &#x62E5;&#x6709;<strong>&#x4E24;&#x79CD;&#x5F62;&#x6001;</strong>&#xFF1A;</p>
<ol>
<li><strong>Transformer Mode&#xFF08;&#x8BAD;&#x7EC3;&#x65F6;&#xFF09;&#xFF1A;</strong> &#x5B83;&#x53EF;&#x4EE5;&#x5199;&#x6210;&#x77E9;&#x9635;&#x5E76;&#x884C;&#x8BA1;&#x7B97;&#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x5229;&#x7528; GPU &#x5E76;&#x884C;&#x8BAD;&#x7EC3;&#x3002;</li>
<li><strong>RNN Mode&#xFF08;&#x63A8;&#x7406;&#x65F6;&#xFF09;&#xFF1A;</strong> &#x5B83;&#x53EF;&#x4EE5;&#x5C55;&#x5F00;&#x6210; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>t</mi><mi>a</mi><mi>t</mi><msub><mi>e</mi><mi>t</mi></msub><mo>=</mo><mi>&#x3B1;</mi><mo>&#x22C5;</mo><mi>S</mi><mi>t</mi><mi>a</mi><mi>t</mi><msub><mi>e</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo>+</mo><mi>I</mi><mi>n</mi><mi>p</mi><mi>u</mi><msub><mi>t</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">State_{t} = \\alpha \\cdot State_{t-1} + Input_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">&#x3B1;</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">n</span><span class="mord mathnormal">p</span><span class="mord mathnormal">u</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> &#x7684;&#x5F62;&#x5F0F;&#xFF0C;&#x63A8;&#x7406;&#x53EA;&#x9700; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> &#x663E;&#x5B58;&#x3002;</li>
</ol>
</li>
<li>
<p><strong>RWKV vs Mamba&#xFF1A;</strong></p>
<ul>
<li><strong>RWKV</strong> &#x66F4;&#x50CF;&#x662F;&#x4E00;&#x4E2A;&#x9B54;&#x6539;&#x7684; Transformer&#xFF08;&#x79FB;&#x9664;&#x4E86; Softmax&#xFF0C;&#x53D8;&#x6210;&#x4E86;&#x7EBF;&#x6027; Attention&#xFF09;&#x3002;</li>
<li><strong>Mamba</strong> &#x6E90;&#x81EA;&#x63A7;&#x5236;&#x7406;&#x8BBA;&#xFF08;Control Theory&#xFF09;&#x548C;&#x4FE1;&#x53F7;&#x5904;&#x7406;&#xFF08;DSP&#xFF09;&#xFF0C;&#x6570;&#x5B66;&#x6839;&#x57FA;&#x662F;&#x5FAE;&#x5206;&#x65B9;&#x7A0B;&#x3002;</li>
<li><strong>Mamba</strong> &#x76EE;&#x524D;&#x5728;&#x5904;&#x7406;&#x957F;&#x5E8F;&#x5217;&#x7684;&#x7406;&#x8BBA;&#x4E0A;&#x9650;&#x4E0A;&#x770B;&#x8D77;&#x6765;&#x66F4;&#x9AD8;&#xFF08;Selective SSM &#x7684;&#x8868;&#x8FBE;&#x80FD;&#x529B;&#x66F4;&#x5F3A;&#xFF09;&#x3002;</li>
</ul>
</li>
</ul>
<hr>
<h2 id="7. DeepSeek / MLA vs Mamba&#xFF1A;&#x65E2;&#x751F;&#x745C;&#xFF0C;&#x4F55;&#x751F;&#x4EAE;&#xFF1F;"><a href="#7. DeepSeek / MLA vs Mamba&#xFF1A;&#x65E2;&#x751F;&#x745C;&#xFF0C;&#x4F55;&#x751F;&#x4EAE;&#xFF1F;"></a>7. DeepSeek / MLA vs Mamba&#xFF1A;&#x65E2;&#x751F;&#x745C;&#xFF0C;&#x4F55;&#x751F;&#x4EAE;&#xFF1F;</h2>
<p><strong>&#x6838;&#x5FC3;&#x7591;&#x95EE;&#xFF1A;</strong> DeepSeek-V3 &#x63A8;&#x51FA;&#x4E86; <strong>MLA (Multi-Head Latent Attention)</strong>&#xFF0C;&#x5C06; KV Cache &#x538B;&#x7F29;&#x4E86; 90% &#x4EE5;&#x4E0A;&#xFF0C;&#x6781;&#x5927;&#x7F13;&#x89E3;&#x4E86; Transformer &#x7684;&#x663E;&#x5B58;&#x74F6;&#x9888;&#x3002;<strong>&#x65E2;&#x7136; Transformer &#x4E5F;&#x80FD;&#x53D8;&#x8F7B;&#xFF0C;&#x8FD8;&#x9700;&#x8981; Mamba &#x5417;&#xFF1F;</strong></p>
<p><strong>&#x7B54;&#x6848;&#xFF1A;&#x9700;&#x8981;&#x3002;&#x4E24;&#x8005;&#x751F;&#x6001;&#x4F4D;&#x4E0D;&#x540C;&#x3002;</strong></p>
<p>&#x867D;&#x7136; MLA &#x662F;&#x4E00;&#x4E2A;&#x5DE5;&#x7A0B;&#x5947;&#x8FF9;&#xFF0C;&#x4F46;&#x5B83;&#x5E76;&#x6CA1;&#x6709;&#x6539;&#x53D8; Transformer &#x7684; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> &#x672C;&#x8D28;&#x3002;Mamba &#x4F9D;&#x7136;&#x62E5;&#x6709;&#x4E09;&#x4E2A; MLA &#x65E0;&#x6CD5;&#x89E6;&#x53CA;&#x7684;&quot;&#x7EDD;&#x5BF9;&#x4F18;&#x52BF;&quot;&#xFF1A;</p>
<h3 id="1. &quot;&#x957F;&quot; vs &quot;&#x65E0;&#x9650;&quot; (Long vs Infinite)"><a href="#1. &quot;&#x957F;&quot; vs &quot;&#x65E0;&#x9650;&quot; (Long vs Infinite)"></a>1. &quot;&#x957F;&quot; vs &quot;&#x65E0;&#x9650;&quot; (Long vs Infinite)</h3>
<ul>
<li><strong>MLA (Transformer)</strong>&#xFF1A;&#x867D;&#x7136; KV Cache &#x53D8;&#x5C0F;&#x4E86;&#xFF0C;&#x4F46;&#x968F;&#x7740;&#x4E0A;&#x4E0B;&#x6587;&#x957F;&#x5EA6;&#x589E;&#x52A0;&#xFF0C;&#x8BA1;&#x7B97;&#x91CF;&#x4ECD;&#x7136;&#x662F; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>&#xFF08;&#x6216;&#x8005; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>&#x22C5;</mo><msub><mi>d</mi><mrow><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N \\cdot d_{head})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF09;&#x3002;
<ul>
<li>&#x63A8;&#x7406; 1M &#x957F;&#x5EA6;&#x65F6;&#xFF0C;&#x5373;&#x4F7F;&#x663E;&#x5B58;&#x591F;&#x7528;&#xFF0C;Attention &#x7684;&#x8BA1;&#x7B97;&#x5EF6;&#x8FDF;&#x4E5F;&#x4F1A;&#x8BA9;&#x4F60;&#x7B49;&#x5F97;&#x82B1;&#x513F;&#x90FD;&#x8C22;&#x4E86;&#x3002;</li>
</ul>
</li>
<li><strong>Mamba</strong>&#xFF1A;&#x8BA1;&#x7B97;&#x91CF;&#x662F; <strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></strong>&#x3002;
<ul>
<li>&#x65E0;&#x8BBA;&#x524D;&#x9762;&#x6709; 1k &#x8FD8;&#x662F; 100M &#x4E2A; Token&#xFF0C;&#x751F;&#x6210;&#x4E0B;&#x4E00;&#x4E2A; Token &#x7684;&#x8BA1;&#x7B97;&#x91CF;<strong>&#x5B8C;&#x5168;&#x4E00;&#x6837;</strong>&#x3002;</li>
<li>&#x8FD9;&#x662F;<strong>&#x771F;&#x6B63;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x65E0;&#x9650;&#x6D41;&#x5F0F;&#x63A8;&#x7406; (Infinite Streaming)</strong> &#x7684;&#x552F;&#x4E00;&#x89E3;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="2. &#x7AEF;&#x4FA7;&#x8BBE;&#x5907;&#x7684;&#x6B7B;&#x5C40; (The Edge Case)"><a href="#2. &#x7AEF;&#x4FA7;&#x8BBE;&#x5907;&#x7684;&#x6B7B;&#x5C40; (The Edge Case)"></a>2. &#x7AEF;&#x4FA7;&#x8BBE;&#x5907;&#x7684;&#x6B7B;&#x5C40; (The Edge Case)</h3>
<ul>
<li><strong>&#x573A;&#x666F;</strong>&#xFF1A;&#x624B;&#x673A;&#x3001;AR &#x773C;&#x955C;&#x3001;&#x8F66;&#x8F7D;&#x82AF;&#x7247;&#x3002;</li>
<li><strong>&#x73B0;&#x72B6;</strong>&#xFF1A;&#x5185;&#x5B58;&#x662F;&#x6B7B;&#x7684;&#xFF08;&#x5982; 8GB&#xFF09;&#x3002;</li>
<li><strong>&#x5BF9;&#x6BD4;</strong>&#xFF1A;
<ul>
<li><strong>MLA</strong>&#xFF1A;&#x63A8;&#x7406;&#x957F;&#x6587;&#x65F6;&#xFF0C;Cache &#x54EA;&#x6015;&#x538B;&#x7F29;&#x4E86;&#xFF0C;&#x4E5F;&#x4F1A;&#x6162;&#x6162;&#x5403;&#x5149;&#x5185;&#x5B58;&#xFF0C;&#x6700;&#x540E; OOM&#xFF08;&#x5185;&#x5B58;&#x6EA2;&#x51FA;&#xFF09;&#x5D29;&#x6389;&#x3002;</li>
<li><strong>Mamba</strong>&#xFF1A;&#x5185;&#x5B58;&#x5360;&#x7528;&#x662F;<strong>&#x6052;&#x5B9A;&#x7684;&#x4E00;&#x6761;&#x76F4;&#x7EBF;</strong>&#x3002;&#x53EA;&#x8981;&#x521A;&#x5F00;&#x59CB;&#x80FD;&#x8DD1;&#xFF0C;&#x8DD1;&#x5230;&#x5929;&#x8352;&#x5730;&#x8001;&#x4E5F;&#x4E0D;&#x4F1A; OOM&#x3002;&#x8FD9;&#x5BF9;&#x4E8E;&#x7AEF;&#x4FA7; Always-on &#x52A9;&#x624B;&#x662F;&#x6551;&#x547D;&#x7A3B;&#x8349;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="3. &#x72B6;&#x6001;&#x7684;&#x7269;&#x7406;&#x610F;&#x4E49; (World Model)"><a href="#3. &#x72B6;&#x6001;&#x7684;&#x7269;&#x7406;&#x610F;&#x4E49; (World Model)"></a>3. &#x72B6;&#x6001;&#x7684;&#x7269;&#x7406;&#x610F;&#x4E49; (World Model)</h3>
<ul>
<li><strong>DeepSeek (Transformer)</strong>&#xFF1A;&#x672C;&#x8D28;&#x662F;&#x79BB;&#x6563;&#x7B26;&#x53F7;&#x7684;&#x7EDF;&#x8BA1;&#x76F8;&#x5173;&#x6027;&#x8BA1;&#x7B97;&#x3002;&#x5B83;&#x901A;&#x8FC7;&#x6D77;&#x91CF;&#x6587;&#x672C;&#x5B66;&#x4E60;&quot;&#x6982;&#x7387;&quot;&#x3002;</li>
<li><strong>Mamba (SSM)</strong>&#xFF1A;&#x672C;&#x8D28;&#x662F;<strong>&#x8FDE;&#x7EED;&#x7CFB;&#x7EDF;&#x7684;&#x79BB;&#x6563;&#x5316;</strong>&#x3002;&#x5B83;&#x7684;&#x72B6;&#x6001; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span> &#x5177;&#x6709;&#x7269;&#x7406;&#x610F;&#x4E49;&#xFF08;&#x5982;&#x4F4D;&#x7F6E;&#x3001;&#x901F;&#x5EA6;&#x3001;&#x52A8;&#x91CF;&#xFF09;&#x3002;
<ul>
<li>&#x56E0;&#x6B64;&#xFF0C;Mamba &#x5728;<strong>&#x4E16;&#x754C;&#x6A21;&#x578B; (World Model)</strong>&#x3001;<strong>&#x673A;&#x5668;&#x4EBA;&#x63A7;&#x5236;</strong>&#x3001;<strong>&#x89C6;&#x9891;&#x751F;&#x6210;</strong>&#x3001;<strong>&#x57FA;&#x56E0;&#x5E8F;&#x5217;&#x5206;&#x6790;</strong>&#x7B49;&#x9700;&#x8981;&#x8FDE;&#x7EED;&#x7269;&#x7406;&#x5148;&#x9A8C;&#x7684;&#x4EFB;&#x52A1;&#x4E0A;&#xFF0C;&#x5C55;&#x73B0;&#x51FA;&#x4E86;&#x6BD4; Transformer &#x66F4;&#x5F3A;&#x7684;&#x5F52;&#x7EB3;&#x504F;&#x7F6E;&#xFF08;Inductive Bias&#xFF09;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="4. &#x663E;&#x5B58;&#x4E0E;&#x80FD;&#x529B;&#x7684;&#x53D6;&#x820D;&#xFF1A;Mamba &#x4E5F;&#x6709;&#x81F4;&#x547D;&#x5F31;&#x70B9;"><a href="#4. &#x663E;&#x5B58;&#x4E0E;&#x80FD;&#x529B;&#x7684;&#x53D6;&#x820D;&#xFF1A;Mamba &#x4E5F;&#x6709;&#x81F4;&#x547D;&#x5F31;&#x70B9;"></a>4. &#x663E;&#x5B58;&#x4E0E;&#x80FD;&#x529B;&#x7684;&#x53D6;&#x820D;&#xFF1A;Mamba &#x4E5F;&#x6709;&#x81F4;&#x547D;&#x5F31;&#x70B9;</h3>
<p>&#x4F60;&#x53EF;&#x80FD;&#x4F1A;&#x95EE;&#xFF1A;<strong>&quot;Mamba &#x663E;&#x5B58;&#x6052;&#x5B9A;&#xFF0C;&#x8FD9;&#x4E48;&#x597D;&#x7684;&#x4E8B;&#xFF0C;&#x4EE3;&#x4EF7;&#x662F;&#x4EC0;&#x4E48;&#xFF1F;&quot;</strong></p>
<p>&#x4EE3;&#x4EF7;&#x975E;&#x5E38;&#x60E8;&#x75DB;&#xFF1A;<strong>Mamba &#x662F;&#x6709;&#x635F;&#x538B;&#x7F29;&#xFF0C;&#x800C; Transformer &#x662F;&#x65E0;&#x635F;&#x56DE;&#x6EAF;&#x3002;</strong></p>
<ul>
<li>
<p><strong>Transformer (KV Cache)</strong>&#xFF1A;</p>
<ul>
<li>&#x628A;&#x6240;&#x6709;&#x5386;&#x53F2;&#x90FD;&#x80CC;&#x5728;&#x8EAB;&#x4E0A;&#x3002;&#x54EA;&#x6015;&#x662F;&#x7B2C; 1 &#x4E2A;&#x8BCD;&#xFF0C;&#x63A8;&#x7406;&#x7B2C; 10000 &#x4E2A;&#x8BCD;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x53EA;&#x8981; Attention &#x6743;&#x91CD;&#x591F;&#x5927;&#xFF0C;&#x4E5F;&#x80FD;<strong>100% &#x7CBE;&#x786E;</strong>&#x5730;&#x627E;&#x56DE;&#x6765;&#x3002;</li>
<li><strong>&#x4EE3;&#x4EF7;</strong>&#xFF1A;&#x663E;&#x5B58;&#x968F;&#x957F;&#x5EA6;&#x7EBF;&#x6027;&#x589E;&#x957F;&#xFF0C;&#x8D8A;&#x6765;&#x8D8A;&#x91CD;&#x3002;</li>
</ul>
</li>
<li>
<p><strong>Mamba (State)</strong>&#xFF1A;</p>
<ul>
<li>&#x4E0D;&#x7BA1;&#x5386;&#x53F2;&#x6709;&#x591A;&#x957F;&#xFF0C;&#x90FD;&#x5FC5;&#x987B;&#x538B;&#x7F29;&#x8FDB;&#x4E00;&#x4E2A;&#x56FA;&#x5B9A;&#x5927;&#x5C0F;&#x7684;&#x76D2;&#x5B50;&#xFF08;&#x72B6;&#x6001; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">h</span></span></span></span>&#xFF09;&#x91CC;&#x3002;</li>
<li><strong>&#x4EE3;&#x4EF7;</strong>&#xFF1A;&#x5F53;&#x4FE1;&#x606F;&#x91CF;&#x8D85;&#x8FC7;&#x76D2;&#x5B50;&#x7684;&#x5BB9;&#x91CF;&#x65F6;&#xFF0C;<strong>&#x5FC5;&#x7136;</strong>&#x4F1A;&#x4E22;&#x5931;&#x7EC6;&#x8282;&#x3002;</li>
<li><strong>&#x5931;&#x8D25;&#x6848;&#x4F8B;</strong>&#xFF1A;<strong>&quot;&#x5927;&#x6D77;&#x635E;&#x9488;&quot; (Needle in a Haystack)</strong> &#x4EFB;&#x52A1;&#x3002;
<ul>
<li>&#x8F93;&#x5165;&#xFF1A;<code>&quot;Key is 12345... (100&#x4E07;&#x5B57;&#x5E9F;&#x8BDD;) ... What is the key?&quot;</code></li>
<li>Transformer&#xFF1A;&#x8F7B;&#x677E;&#x79D2;&#x6740;&#xFF08;Attention &#x76F4;&#x63A5;&#x5B9A;&#x4F4D;&#x5230; <code>Key</code>&#xFF09;&#x3002;</li>
<li>Mamba&#xFF1A;&#x5927;&#x6982;&#x7387;&#x5931;&#x8D25;&#xFF08;<code>12345</code> &#x65E9;&#x5C31;&#x5728; 100 &#x4E07;&#x6B21;&#x72B6;&#x6001;&#x66F4;&#x65B0;&#x4E2D;&#x88AB;&quot;&#x78E8;&#x635F;&quot;&#x6389;&#x4E86;&#xFF09;&#x3002;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>&#x7ED3;&#x8BBA;&#xFF1A;</strong></p>
<ul>
<li><strong>&#x4E91;&#x7AEF; + &#x590D;&#x6742;&#x903B;&#x8F91;&#x63A8;&#x7406; + &#x7CBE;&#x786E;&#x56DE;&#x6EAF;</strong>&#xFF1A;DeepSeek (Transformer + MLA) &#x662F;&#x738B;&#x8005;&#x3002;</li>
<li><strong>&#x7AEF;&#x4FA7; + &#x8D85;&#x957F;&#x4E0A;&#x4E0B;&#x6587; + &#x6A21;&#x7CCA;&#x6A21;&#x5F0F;&#x8BC6;&#x522B;</strong>&#xFF1A;Mamba &#x662F;&#x672A;&#x6765;&#x3002;</li>
<li><strong>&#x7EC8;&#x5C40;</strong>&#xFF1A;&#x5F88;&#x53EF;&#x80FD;&#x662F; <strong>Hybrid&#xFF08;&#x6DF7;&#x5408;&#x67B6;&#x6784;&#xFF09;</strong> &#x2014;&#x2014; &#x7528; Mamba &#x5904;&#x7406;&#x6D77;&#x91CF;&#x6D41;&#x5F0F;&#x8F93;&#x5165;&#xFF08;&#x773C;&#x775B;/&#x8033;&#x6735;&#xFF09;&#xFF0C;&#x7528; Transformer &#x5904;&#x7406;&#x5173;&#x952E;&#x5E27;&#x7684;&#x903B;&#x8F91;&#x601D;&#x8003;&#xFF08;&#x5927;&#x8111;&#xFF09;&#x3002;</li>
</ul>
<h3 id="5. &#x7075;&#x9B42;&#x62F7;&#x95EE;&#xFF1A;&#x65E2;&#x7136;&#x662F;&#x6709;&#x635F;&#x7684;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x7406;&#x80FD;&#x529B;&#x8FD8;&#x6BD4; Transformer &#x5F3A;&#xFF1F;"><a href="#5. &#x7075;&#x9B42;&#x62F7;&#x95EE;&#xFF1A;&#x65E2;&#x7136;&#x662F;&#x6709;&#x635F;&#x7684;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x7406;&#x80FD;&#x529B;&#x8FD8;&#x6BD4; Transformer &#x5F3A;&#xFF1F;"></a>5. &#x7075;&#x9B42;&#x62F7;&#x95EE;&#xFF1A;&#x65E2;&#x7136;&#x662F;&#x6709;&#x635F;&#x7684;&#xFF0C;&#x4E3A;&#x4EC0;&#x4E48;&#x63A8;&#x7406;&#x80FD;&#x529B;&#x8FD8;&#x6BD4; Transformer &#x5F3A;&#xFF1F;</h3>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x53CD;&#x76F4;&#x89C9;&#x4F46;&#x975E;&#x5E38;&#x5173;&#x952E;&#x7684;&#x95EE;&#x9898;&#x3002;Mamba &#x7ECF;&#x5E38;&#x5728;&#x9700;&#x8981;&#x903B;&#x8F91;&#x63A8;&#x7406;&#x7684;&#x4EFB;&#x52A1;&#xFF08;&#x5982;&#x6570;&#x5B66;&#x3001;&#x7F16;&#x7A0B;&#xFF09;&#x4E0A;&#x5C55;&#x73B0;&#x51FA;&#x60CA;&#x4EBA;&#x7684;&#x6548;&#x679C;&#x3002;</p>
<p><strong>&#x7B54;&#x6848;&#xFF1A;&#x6709;&#x635F;&#x4E0D;&#x4EE3;&#x8868;&#x65E0;&#x80FD;&#xFF0C;&#x6709;&#x65F6;&#x5019;&quot;&#x5B66;&#x4F1A;&#x9057;&#x5FD8;&quot;&#x53CD;&#x800C;&#x662F;&#x66F4;&#x9AD8;&#x9636;&#x7684;&#x667A;&#x80FD;&#x3002;</strong></p>
<ul>
<li>
<p><strong>&#x62BD;&#x8C61;&#x80FD;&#x529B;&#x7684;&#x5012;&#x903C; (Information Bottleneck)</strong>&#xFF1A;</p>
<ul>
<li>Transformer &#x50CF;&#x4E00;&#x4E2A;&#x53EA;&#x4F1A;<strong>&#x6B7B;&#x8BB0;&#x786C;&#x80CC;</strong>&#x7684;&#x5B66;&#x751F;&#xFF08;KV Cache&#xFF09;&#x3002;&#x8003;&#x8BD5;&#x65F6;&#xFF08;&#x63A8;&#x7406;&#xFF09;&#xFF0C;&#x5B83;&#x901A;&#x8FC7;&#x7FFB;&#x4E66;&#xFF08;Attention&#xFF09;&#x627E;&#x5230;&#x539F;&#x9898;&#x3002;&#x8FD9;&#x79CD;&quot;&#x8FC7;&#x62DF;&#x5408;&quot;&#x53EF;&#x80FD;&#x963B;&#x788D;&#x4E86;&#x5BF9;&#x901A;&#x7528;&#x89C4;&#x5F8B;&#x7684;&#x5B66;&#x4E60;&#x3002;</li>
<li>Mamba &#x50CF;&#x4E00;&#x4E2A;<strong>&#x7406;&#x89E3;&#x529B;&#x5F3A;</strong>&#x7684;&#x5B66;&#x751F;&#x3002;&#x7531;&#x4E8E;&#x8111;&#x5BB9;&#x91CF;&#x6709;&#x9650;&#xFF08;State&#xFF09;&#xFF0C;&#x5B83;&#x88AB;&#x8FEB;&#x628A;&#x5177;&#x8C61;&#x7684;&#x4FE1;&#x606F;&#xFF08;Token&#xFF09;<strong>&#x538B;&#x7F29;&#x6210;&#x62BD;&#x8C61;&#x7684;&#x89C4;&#x5F8B;</strong>&#x3002;&#x8FD9;&#x79CD;&#x88AB;&#x8FEB;&#x7684;&#x62BD;&#x8C61;&#xFF0C;&#x53CD;&#x800C;&#x4FC3;&#x6210;&#x4E86;&#x66F4;&#x9AD8;&#x9636;&#x7684;&#x8BED;&#x4E49;&#x8868;&#x5F81;&#x3002;</li>
</ul>
</li>
<li>
<p><strong>&#x8FDE;&#x7EED;&#x6027;&#x7684;&#x601D;&#x7EF4;&#x6D41; (Continuous Flow)</strong>&#xFF1A;</p>
<ul>
<li>&#x903B;&#x8F91;&#x63A8;&#x7406;&#x5F80;&#x5F80;&#x9700;&#x8981;<strong>&#x8FDE;&#x8D2F;&#x7684;&#x601D;&#x7EF4;&#x94FE;</strong>&#x3002;</li>
<li>Mamba &#x7684;&#x72B6;&#x6001;&#x662F;&#x8FDE;&#x7EED;&#x6F14;&#x5316;&#x7684;&#xFF0C;&#x66F4;&#x7B26;&#x5408;&#x8FD9;&#x79CD;<strong>&#x601D;&#x7EF4;&#x6D41; (Flow)</strong>&#x3002;&#x800C; Transformer &#x662F;&#x79BB;&#x6563;&#x7684; Token &#x5904;&#x7406;&#x5668;&#xFF0C;&#x63A8;&#x7406;&#x662F;&#x8DF3;&#x8DC3;&#x7684; Pattern Matching&#xFF0C;&#x66F4;&#x5BB9;&#x6613;&#x88AB;&#x4E2D;&#x95F4;&#x7684;&#x566A;&#x97F3;&#x6253;&#x65AD;&#x3002;</li>
</ul>
</li>
<li>
<p><strong>&#x65E0;&#x9650;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x7EA2;&#x5229;</strong>&#xFF1A;</p>
<ul>
<li>&#x867D;&#x7136;&#x6BCF;&#x4E2A;&#x70B9;&#x662F;&#x6709;&#x635F;&#x7684;&#xFF0C;&#x4F46; Mamba &#x80FD;&quot;&#x770B;&quot;&#x66F4;&#x957F;&#x7684;&#x4E66;&#x3002;</li>
<li><strong>&#x8BFB; 100 &#x672C;&#x4E66;&#xFF08;&#x6709;&#x635F;&#xFF09;&#x7684;&#x4EBA;&#xFF0C;&#x901A;&#x5E38;&#x6BD4;&#x7CBE;&#x8BFB; 1 &#x672C;&#x4E66;&#xFF08;&#x65E0;&#x635F;&#xFF09;&#x7684;&#x4EBA;&#x66F4;&#x6709;&#x667A;&#x6167;&#x3002;</strong> &#x5728;&#x5904;&#x7406;&#x8D85;&#x957F;&#x6587;&#x6863;&#x5F52;&#x7EB3;&#x3001;&#x4EE3;&#x7801;&#x5E93;&#x7406;&#x89E3;&#x65F6;&#xFF0C;&quot;&#x80FD;&#x770B;&#x5B8C;&quot;&#x6BD4;&quot;&#x8BB0;&#x5F97;&#x6BCF;&#x4E00;&#x4E2A;&#x5B57;&quot;&#x66F4;&#x91CD;&#x8981;&#x3002;</li>
</ul>
</li>
</ul>
<h3 id="6. &#x5DE5;&#x7A0B;&#x5B9E;&#x8DF5;&#xFF1A;&#x8BB0;&#x5FC6;&#x76D2;&#x5B50;&#x8BE5;&#x8BBE;&#x8BA1;&#x591A;&#x5927;&#xFF1F;"><a href="#6. &#x5DE5;&#x7A0B;&#x5B9E;&#x8DF5;&#xFF1A;&#x8BB0;&#x5FC6;&#x76D2;&#x5B50;&#x8BE5;&#x8BBE;&#x8BA1;&#x591A;&#x5927;&#xFF1F;"></a>6. &#x5DE5;&#x7A0B;&#x5B9E;&#x8DF5;&#xFF1A;&#x8BB0;&#x5FC6;&#x76D2;&#x5B50;&#x8BE5;&#x8BBE;&#x8BA1;&#x591A;&#x5927;&#xFF1F;</h3>
<p>&#x5BF9;&#x4E8E;&#x60F3;&#x590D;&#x73B0;&#x6216;&#x4F7F;&#x7528; Mamba &#x7684;&#x5F00;&#x53D1;&#x8005;&#xFF0C;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x5FC5;&#x987B;&#x9762;&#x5BF9;&#x7684; <strong>Trade-off&#xFF08;&#x6743;&#x8861;&#xFF09;</strong> &#x95EE;&#x9898;&#x3002;&#x6CA1;&#x6709;&#x6807;&#x51C6;&#x7B54;&#x6848;&#xFF0C;&#x4F46;&#x6709;&#x6700;&#x4F73;&#x5B9E;&#x8DF5;&#xFF1A;</p>
<ol>
<li>
<p><strong>State Dimension (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>)</strong>&#xFF1A;&#x901A;&#x5E38;&#x8BBE;&#x4E3A; <strong>16</strong>&#x3002;</p>
<ul>
<li>&#x6CE8;&#x610F;&#xFF1A;&#x8FD9;&#x770B;&#x8D77;&#x6765;&#x5F88;&#x5C0F;&#xFF08;&#x76F8;&#x6BD4;&#x4E8E; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>m</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi>l</mi></mrow></msub><mo>=</mo><mn>4096</mn></mrow><annotation encoding="application/x-tex">D_{model}=4096</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">&#x200B;</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4096</span></span></span></span>&#xFF09;&#xFF0C;&#x4F46;&#x5B83;&#x662F;<strong>&#x6BCF;&#x4E2A; Head</strong> &#x7684;&#x72B6;&#x6001;&#x5927;&#x5C0F;&#x3002;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x592A;&#x5C0F;&#xFF1A;&#x8BB0;&#x4E0D;&#x4F4F;&#x7EC6;&#x8282;&#x3002;</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x592A;&#x5927;&#xFF1A;&#x8BA1;&#x7B97;&#x5F00;&#x9500;&#x7EBF;&#x6027;&#x589E;&#x52A0;&#xFF08;<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo>&#x22C5;</mo><mi>L</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N \\cdot L)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">&#x22C5;</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mclose">)</span></span></span></span>&#xFF09;&#xFF0C;&#x62D6;&#x6162;&#x8BAD;&#x7EC3;&#x901F;&#x5EA6;&#x3002;</li>
<li><em>Mamba-2 &#x7684;&#x6539;&#x8FDB;</em>&#xFF1A;&#x901A;&#x8FC7;&#x67B6;&#x6784;&#x4F18;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span> &#x505A;&#x5F97;&#x66F4;&#x5927;&#xFF08;&#x5982; 64 &#x6216; 128&#xFF09;&#xFF0C;&#x4EE5;&#x63D0;&#x5347;&#x8BB0;&#x5FC6;&#x5BB9;&#x91CF;&#x3002;</li>
</ul>
</li>
<li>
<p><strong>Expansion Factor (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span></span></span></span>)</strong>&#xFF1A;&#x901A;&#x5E38;&#x8BBE;&#x4E3A; <strong>2</strong>&#x3002;</p>
<ul>
<li>&#x628A;&#x8F93;&#x5165;&#x7EF4;&#x5EA6; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> &#x653E;&#x5927;&#x5230; <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>D</mi></mrow><annotation encoding="application/x-tex">2D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> &#x518D;&#x8FDB; SSM&#xFF0C;&#x7136;&#x540E;&#x518D;&#x538B;&#x56DE;&#x6765;&#x3002;&#x8FD9;&#x589E;&#x52A0;&#x4E86;&#x6A21;&#x578B;&#x7684;&quot;&#x5E26;&#x5BBD;&quot;&#x3002;</li>
</ul>
</li>
</ol>
<hr>
<h2 id="8. &#x603B;&#x7ED3;&#xFF1A;Mamba &#x7684;&#x4F4D;&#x7F6E;"><a href="#8. &#x603B;&#x7ED3;&#xFF1A;Mamba &#x7684;&#x4F4D;&#x7F6E;"></a>8. &#x603B;&#x7ED3;&#xFF1A;Mamba &#x7684;&#x4F4D;&#x7F6E;</h2>
<table>
<thead>
<tr>
<th style="text-align:left">&#x7279;&#x6027;</th>
<th style="text-align:left">Transformer</th>
<th style="text-align:left">&#x4F20;&#x7EDF; RNN (LSTM)</th>
<th style="text-align:left">Mamba / RWKV</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>&#x8BAD;&#x7EC3;&#x901F;&#x5EA6;</strong></td>
<td style="text-align:left"><strong>&#x5FEB; (&#x5E76;&#x884C;)</strong></td>
<td style="text-align:left">&#x6162; (&#x4E32;&#x884C;)</td>
<td style="text-align:left"><strong>&#x5FEB; (&#x5E76;&#x884C;&#x626B;&#x63CF;)</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>&#x63A8;&#x7406;&#x901F;&#x5EA6;</strong></td>
<td style="text-align:left">&#x6162; (&#x751F;&#x6210;&#x6BCF;&#x4E2A;&#x8BCD;&#x90FD;&#x8981;&#x56DE;&#x5934;&#x770B;&#x6240;&#x6709;&#x8BCD;)</td>
<td style="text-align:left"><strong>&#x5FEB; (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>)</strong></td>
<td style="text-align:left"><strong>&#x5FEB; (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>)</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>&#x63A8;&#x7406;&#x663E;&#x5B58;</strong></td>
<td style="text-align:left"><strong>&#x7206;&#x70B8; (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span> KV Cache)</strong></td>
<td style="text-align:left"><strong>&#x6052;&#x5B9A; (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> State)</strong></td>
<td style="text-align:left"><strong>&#x6052;&#x5B9A; (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span> State)</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>&#x5E8F;&#x5217;&#x957F;&#x5EA6;</strong></td>
<td style="text-align:left">&#x53D7;&#x9650;&#x4E8E;&#x663E;&#x5B58; (&#x901A;&#x5E38; &lt; 32k)</td>
<td style="text-align:left">&#x7406;&#x8BBA;&#x65E0;&#x9650;&#xFF0C;&#x4F46;&#x4F1A;&#x9057;&#x5FD8;</td>
<td style="text-align:left"><strong>&#x767E;&#x4E07;&#x7EA7; (1M+)</strong></td>
</tr>
<tr>
<td style="text-align:left"><strong>&#x6838;&#x5FC3;&#x673A;&#x5236;</strong></td>
<td style="text-align:left">Attention (&#x5168;&#x8FDE;&#x63A5;&#x56FE;)</td>
<td style="text-align:left">Gating (&#x95E8;&#x63A7;&#x9012;&#x5F52;)</td>
<td style="text-align:left"><strong>Selective SSM (&#x9009;&#x62E9;&#x6027;&#x72B6;&#x6001;&#x7A7A;&#x95F4;)</strong></td>
</tr>
</tbody>
</table>
<p>Mamba &#x7684;&#x51FA;&#x73B0;&#xFF0C;&#x6253;&#x7834;&#x4E86;&quot;Transformer &#x662F;&#x552F;&#x4E00;&#x89E3;&quot;&#x7684;&#x8FF7;&#x4FE1;&#x3002;&#x5B83;&#x544A;&#x8BC9;&#x6211;&#x4EEC;&#xFF1A;&#x53EA;&#x8981;&#x6570;&#x5B66;&#x5DE5;&#x5177;&#x7528;&#x5F97;&#x5BF9;&#xFF0C;RNN &#x7684;&#x7075;&#x9B42;&#xFF08;&#x72B6;&#x6001;&#x538B;&#x7F29;&#xFF09;&#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x88C5;&#x8FDB; GPU &#x7684;&#x8EAF;&#x58F3;&#xFF08;&#x5E76;&#x884C;&#x8BA1;&#x7B97;&#xFF09;&#x91CC;&#xFF0C;&#x8FDB;&#x5316;&#x51FA;&#x66F4;&#x5F3A;&#x7684;&#x751F;&#x7269;&#x3002;</p>
<h1 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h1>
<ul>
<li><a href="https://arxiv.org/html/2312.00752v2">Mamba &#x8BBA;&#x6587;</a></li>
<li><a href="https://newsletter.maartengrootendorst.com/p/a-visual-guide-to-mamba-and-state">The Illustrated Mamba</a></li>
<li><a href="https://github.com/BlinkDL/RWKV-LM">RWKV &#x9879;&#x76EE;&#x4E3B;&#x9875;</a></li>
</ul>
<p><em>&#x7F16;&#x8F91;&#xFF1A;2026-02-02</em></p>
`,n=[{level:2,title:" Mamba",children:[]},{level:2,title:"1. ",children:[{level:3,title:"Part 1:   ",children:[]},{level:3,title:'Part 2:   ""',children:[]},{level:3,title:"Part 3:    GPU ",children:[]},{level:3,title:"Part 4:   Mamba Block",children:[]}]},{level:2,title:"2.  Mamba ",children:[{level:3,title:"1.  Mamba ",children:[]},{level:3,title:"2. ",children:[]},{level:3,title:"3. ",children:[]}]},{level:2,title:"3. Mamba vs Transformer",children:[{level:3,title:"A. ",children:[]},{level:3,title:"B. Block ",children:[{level:4,title:"Transformer Block ()",children:[]},{level:4,title:"Mamba Block ( SSM)",children:[]}]}]},{level:2,title:"4. ",children:[{level:3,title:" SSM  5 ",children:[]},{level:3,title:" ",children:[]},{level:3,title:"  \\Delta  a,ba, ba,b",children:[{level:4,title:" ",children:[]},{level:4,title:"\\Delta ",children:[]},{level:4,title:"",children:[]},{level:4,title:" A,B\\bar{A}, \\bar{B}A,B",children:[]}]},{level:3,title:"  ",children:[]},{level:3,title:"  ",children:[]},{level:3,title:" Mamba Block",children:[]},{level:3,title:"",children:[]}]},{level:2,title:"5.  Mamba ",children:[{level:3,title:"5.1  Token ",children:[]},{level:3,title:"5.2 ",children:[{level:4,title:' 1: Conv1d(kernel=4)  ""',children:[]},{level:4,title:' 2: SiLU   ""',children:[]},{level:4,title:' 3: SSM   ""',children:[]},{level:4,title:' 4:   ""',children:[]}]},{level:3,title:"5.3  Mamba  Transformer ",children:[{level:4,title:"",children:[]},{level:4,title:"",children:[]}]},{level:3,title:"5.4 Mamba  ",children:[{level:4,title:" 1:  = ",children:[]},{level:4,title:" 2:  = ",children:[]},{level:4,title:" 3:  = ",children:[]}]},{level:3,title:"5.5 Mamba vs Transformer",children:[]}]},{level:2,title:"6. RWKV ",children:[]},{level:2,title:"7. DeepSeek / MLA vs Mamba",children:[{level:3,title:'1. "" vs "" (Long vs Infinite)',children:[]},{level:3,title:"2.  (The Edge Case)",children:[]},{level:3,title:"3.  (World Model)",children:[]},{level:3,title:"4. Mamba ",children:[]},{level:3,title:"5.  Transformer ",children:[]},{level:3,title:"6. ",children:[]}]},{level:2,title:"8. Mamba ",children:[]},{level:1,title:"",children:[]}];export{s as attributes,a as html,n as nestedHeaders};
